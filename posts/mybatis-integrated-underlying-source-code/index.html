<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charset="UTF-8"><style>:where(img){height:auto}</style><meta name="viewport" content="width=device-width"><link rel="icon" type="image" href="/astro/favicon.ico"><link rel="canonical" href="https://chou401.github.io/astro/posts/mybatis-integrated-underlying-source-code/"><meta name="generator" content="Astro v4.9.2"><!-- General Meta Tags --><title>Mybatis | 知道的越多，才知知道的越少</title><meta name="title" content="Mybatis | 知道的越多，才知知道的越少"><meta name="description" content="Mybatis 项目集成实现和重点底层源码分析"><meta name="author" content="chou401"><link rel="sitemap" href="/sitemap-index.xml"><!-- Open Graph / Facebook --><meta property="og:title" content="Mybatis | 知道的越多，才知知道的越少"><meta property="og:description" content="Mybatis 项目集成实现和重点底层源码分析"><meta property="og:url" content="https://chou401.github.io/astro/posts/mybatis-integrated-underlying-source-code/"><meta property="og:image" content="https://chou401.github.io/posts/mybatis.png"><!-- Article Published/Modified time --><meta property="article:published_time" content="2022-09-25T15:20:35.000Z"><meta property="article:modified_time" content="2024-02-22T00:37:28.000Z"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://chou401.github.io/astro/posts/mybatis-integrated-underlying-source-code/"><meta property="twitter:title" content="Mybatis | 知道的越多，才知知道的越少"><meta property="twitter:description" content="Mybatis 项目集成实现和重点底层源码分析"><meta property="twitter:image" content="https://chou401.github.io/posts/mybatis.png"><!-- Google Font --><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,400;0,500;0,600;0,700;1,400;1,600&amp;display=swap" rel="stylesheet"><meta name="theme-color" content=""><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script src="/astro/toggle-theme.js"></script><style>*,:before,:after{box-sizing:border-box;border:0 solid #e5e7eb}:before,:after{--tw-content:""}html,:host{-webkit-text-size-adjust:100%;tab-size:4;font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5}body{line-height:inherit;margin:0}hr{color:inherit;border-top-width:1px;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-feature-settings:normal;font-variation-settings:normal;font-family:IBM Plex Mono,monospace;font-size:1em}small{font-size:80%}sub,sup{vertical-align:baseline;font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-feature-settings:inherit;font-variation-settings:inherit;font-family:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:#0000;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button{height:auto}::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{margin:0;padding:0;list-style:none}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder{opacity:1;color:#9ca3af}textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{vertical-align:middle;display:block}img,video{max-width:100%;height:auto}[hidden]{display:none}:root,html[data-theme=light]{--color-fill:251,254,251;--color-text-base:40,39,40;--color-accent:0,108,172;--color-card:230,230,230;--color-card-muted:205,205,205;--color-border:236,233,233}html[data-theme=dark]{--color-fill:33,39,55;--color-text-base:234,237,243;--color-accent:255,107,1;--color-card:52,63,96;--color-card-muted:138,51,2;--color-border:171,75,8}#sun-svg,html[data-theme=dark] #moon-svg{display:none}#moon-svg,html[data-theme=dark] #sun-svg{display:block}body{--tw-bg-opacity:1;background-color:rgba(var(--color-fill),var(--tw-bg-opacity));--tw-text-opacity:1;color:rgba(var(--color-text-base),var(--tw-text-opacity));flex-direction:column;min-height:100svh;font-family:IBM Plex Mono,monospace;display:flex}body ::selection{background-color:rgba(var(--color-accent),var(--tw-bg-opacity));--tw-bg-opacity:.7;--tw-text-opacity:1;color:rgba(var(--color-fill),var(--tw-text-opacity))}body::selection{background-color:rgba(var(--color-accent),var(--tw-bg-opacity));--tw-bg-opacity:.7;--tw-text-opacity:1;color:rgba(var(--color-fill),var(--tw-text-opacity))}section,footer{max-width:48rem;margin-left:auto;margin-right:auto;padding-left:1rem;padding-right:1rem}a{outline-offset:1px;outline-width:2px;outline-color:rgb(var(--color-accent))}a:focus-visible{outline-style:dashed;text-decoration-line:none}svg{fill:rgb(var(--color-text-base));width:1.5rem;height:1.5rem;display:inline-block}.group:hover svg{fill:rgb(var(--color-accent))}svg.icon-tabler{--tw-scale-x:1.25;--tw-scale-y:1.25;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y));fill:#0000;stroke:currentColor;stroke-width:2px;opacity:.9;width:1.5rem;height:1.5rem;display:inline-block}.group:hover svg.icon-tabler{fill:#0000}@media (min-width:640px){svg.icon-tabler{--tw-scale-x:1.1;--tw-scale-y:1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}}.prose :where(h1,h2,h3,h4,h5,h6,th):not(:where([class~=not-prose],[class~=not-prose] *)){--tw-text-opacity:1!important;color:rgba(var(--color-text-base),var(--tw-text-opacity))!important;margin-bottom:.75rem!important}.prose :where(h3):not(:where([class~=not-prose],[class~=not-prose] *)){font-style:italic}.prose :where(p):not(:where([class~=not-prose],[class~=not-prose] *)){--tw-text-opacity:1!important;color:rgba(var(--color-text-base),var(--tw-text-opacity))!important}.prose :where(a):not(:where([class~=not-prose],[class~=not-prose] *)){text-underline-offset:8px;--tw-text-opacity:1!important;color:rgba(var(--color-text-base),var(--tw-text-opacity))!important;text-decoration-style:dashed!important}.prose :where(a):not(:where([class~=not-prose],[class~=not-prose] *)):hover{--tw-text-opacity:1;color:rgba(var(--color-accent),var(--tw-text-opacity))}.prose :where(blockquote):not(:where([class~=not-prose],[class~=not-prose] *)){--tw-border-opacity:.5;opacity:.8;border-left-color:rgba(var(--color-accent),var(--tw-border-opacity))!important}.prose :where(figcaption):not(:where([class~=not-prose],[class~=not-prose] *)){opacity:.7;--tw-text-opacity:1!important;color:rgba(var(--color-text-base),var(--tw-text-opacity))!important}.prose :where(strong):not(:where([class~=not-prose],[class~=not-prose] *)){--tw-text-opacity:1!important;color:rgba(var(--color-text-base),var(--tw-text-opacity))!important}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)){background-color:rgba(var(--color-card),var(--tw-bg-opacity));--tw-bg-opacity:.75;border-radius:.25rem;padding:.25rem}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):before,.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):after{--tw-content:none!important;content:var(--tw-content)!important}.prose :where(ol):not(:where([class~=not-prose],[class~=not-prose] *)){--tw-text-opacity:1!important;color:rgba(var(--color-text-base),var(--tw-text-opacity))!important}.prose :where(ul):not(:where([class~=not-prose],[class~=not-prose] *)){overflow-x:clip;--tw-text-opacity:1!important;color:rgba(var(--color-text-base),var(--tw-text-opacity))!important}.prose * :where(li):not(:where([class~=not-prose],[class~=not-prose] *))::marker,.prose :where(li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:rgba(var(--color-accent),var(--tw-text-opacity))!important}.prose :where(table):not(:where([class~=not-prose],[class~=not-prose] *)){--tw-text-opacity:1;color:rgba(var(--color-text-base),var(--tw-text-opacity))}.prose :where(th):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(td):not(:where([class~=not-prose],[class~=not-prose] *)){--tw-border-opacity:1;border-width:1px;border-color:rgba(var(--color-border),var(--tw-border-opacity))}.prose :where(img):not(:where([class~=not-prose],[class~=not-prose] *)){--tw-border-opacity:1;border-width:2px;border-color:rgba(var(--color-border),var(--tw-border-opacity));margin-left:auto;margin-right:auto;margin-top:.5rem!important;margin-bottom:.5rem!important}.prose :where(hr):not(:where([class~=not-prose],[class~=not-prose] *)){--tw-border-opacity:1!important;border-color:rgba(var(--color-border),var(--tw-border-opacity))!important}.prose a{overflow-wrap:break-word}.prose a:hover{--tw-text-opacity:1!important;color:rgba(var(--color-accent),var(--tw-text-opacity))!important}.prose thead th:first-child,tbody td:first-child,tfoot td:first-child{padding-left:.571429em}.prose h2#table-of-contents{margin-bottom:.5rem}.prose details{cursor:pointer;-webkit-user-select:none;user-select:none;--tw-text-opacity:1;color:rgba(var(--color-text-base),var(--tw-text-opacity));display:inline-block}.prose summary{outline-offset:1px;outline-width:2px;outline-color:rgb(var(--color-accent))}.prose summary:focus-visible{outline-style:dashed;text-decoration-line:none}.prose h2#table-of-contents+p{display:none}html{overflow-y:scroll}::-webkit-scrollbar{width:.75rem}::-webkit-scrollbar-track{--tw-bg-opacity:1;background-color:rgba(var(--color-fill),var(--tw-bg-opacity))}::-webkit-scrollbar-thumb{--tw-bg-opacity:1;background-color:rgba(var(--color-card),var(--tw-bg-opacity))}::-webkit-scrollbar-thumb:hover{--tw-bg-opacity:1;background-color:rgba(var(--color-card-muted),var(--tw-bg-opacity))}code,blockquote{word-wrap:break-word}pre>code{white-space:pre}*,:before,:after,::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:#3b82f680;--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.container{width:100%}@media (min-width:640px){.container{max-width:640px}}.prose{color:var(--tw-prose-body);max-width:65ch}.prose :where(p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em;margin-bottom:1.25em}.prose :where([class~=lead]):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-lead);margin-top:1.2em;margin-bottom:1.2em;font-size:1.25em;line-height:1.6}.prose :where(a):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-links);font-weight:500;text-decoration:underline}.prose :where(strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-bold);font-weight:600}.prose :where(a strong):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(blockquote strong):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(thead th strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(ol):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em;margin-bottom:1.25em;padding-inline-start:1.625em;list-style-type:decimal}.prose :where(ol[type=A]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=A s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=I]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type=I s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type="1"]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:decimal}.prose :where(ul):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em;margin-bottom:1.25em;padding-inline-start:1.625em;list-style-type:disc}.prose :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:var(--tw-prose-counters);font-weight:400}.prose :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:var(--tw-prose-bullets)}.prose :where(dt):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);margin-top:1.25em;font-weight:600}.prose :where(hr):not(:where([class~=not-prose],[class~=not-prose] *)){border-color:var(--tw-prose-hr);border-top-width:1px;margin-top:3em;margin-bottom:3em}.prose :where(blockquote):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-quotes);border-inline-start-width:.25rem;border-inline-start-color:var(--tw-prose-quote-borders);quotes:"“""”""‘""’";margin-top:1.6em;margin-bottom:1.6em;padding-inline-start:1em;font-style:italic;font-weight:500}.prose :where(blockquote p:first-of-type):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:open-quote}.prose :where(blockquote p:last-of-type):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:close-quote}.prose :where(h1):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);margin-top:0;margin-bottom:.888889em;font-size:2.25em;font-weight:800;line-height:1.11111}.prose :where(h1 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:900}.prose :where(h2):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);margin-top:2em;margin-bottom:1em;font-size:1.5em;font-weight:700;line-height:1.33333}.prose :where(h2 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:800}.prose :where(h3):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);margin-top:1.6em;margin-bottom:.6em;font-size:1.25em;font-weight:600;line-height:1.6}.prose :where(h3 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:700}.prose :where(h4):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);margin-top:1.5em;margin-bottom:.5em;font-weight:600;line-height:1.5}.prose :where(h4 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:700}.prose :where(img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.prose :where(picture):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2em;margin-bottom:2em;display:block}.prose :where(video):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.prose :where(kbd):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-kbd);box-shadow:0 0 0 1px rgb(var(--tw-prose-kbd-shadows)/10%),0 3px rgb(var(--tw-prose-kbd-shadows)/10%);padding-top:.1875em;padding-inline-end:.375em;padding-bottom:.1875em;border-radius:.3125rem;padding-inline-start:.375em;font-family:inherit;font-size:.875em;font-weight:500}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.875em;font-weight:600}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):before,.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:"`"}.prose :where(a code):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(h1 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(h2 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-size:.875em}.prose :where(h3 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-size:.9em}.prose :where(h4 code):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(blockquote code):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(thead th code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(pre):not(:where([class~=not-prose],[class~=not-prose] *)){background-color:var(--tw-prose-pre-bg);padding-top:.857143em;padding-inline-end:1.14286em;padding-bottom:.857143em;border-radius:.375rem;margin-top:1.71429em;margin-bottom:1.71429em;padding-inline-start:1.14286em;font-size:.875em;font-weight:400;line-height:1.71429;overflow-x:auto}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:inherit;color:inherit;font-size:inherit;font-family:inherit;line-height:inherit;background-color:#0000;border-width:0;border-radius:0;padding:0}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)):before,.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:none}.prose :where(table):not(:where([class~=not-prose],[class~=not-prose] *)){table-layout:auto;text-align:start;width:100%;margin-top:2em;margin-bottom:2em;font-size:.875em;line-height:1.71429}.prose :where(thead):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-width:1px;border-bottom-color:var(--tw-prose-th-borders)}.prose :where(thead th):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);vertical-align:bottom;padding-inline-end:.571429em;padding-bottom:.571429em;padding-inline-start:.571429em;font-weight:600}.prose :where(tbody tr):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-width:1px;border-bottom-color:var(--tw-prose-td-borders)}.prose :where(tbody tr:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-width:0}.prose :where(tbody td):not(:where([class~=not-prose],[class~=not-prose] *)){vertical-align:baseline}.prose :where(tfoot):not(:where([class~=not-prose],[class~=not-prose] *)){border-top-width:1px;border-top-color:var(--tw-prose-th-borders)}.prose :where(tfoot td):not(:where([class~=not-prose],[class~=not-prose] *)){vertical-align:top}.prose :where(figure>*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0;margin-bottom:0}.prose :where(figcaption):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-captions);margin-top:.857143em;font-size:.875em;line-height:1.42857}.prose{--tw-prose-body:#374151;--tw-prose-headings:#111827;--tw-prose-lead:#4b5563;--tw-prose-links:#111827;--tw-prose-bold:#111827;--tw-prose-counters:#6b7280;--tw-prose-bullets:#d1d5db;--tw-prose-hr:#e5e7eb;--tw-prose-quotes:#111827;--tw-prose-quote-borders:#e5e7eb;--tw-prose-captions:#6b7280;--tw-prose-kbd:#111827;--tw-prose-kbd-shadows:17 24 39;--tw-prose-code:#111827;--tw-prose-pre-code:#e5e7eb;--tw-prose-pre-bg:#1f2937;--tw-prose-th-borders:#d1d5db;--tw-prose-td-borders:#e5e7eb;--tw-prose-invert-body:#d1d5db;--tw-prose-invert-headings:#fff;--tw-prose-invert-lead:#9ca3af;--tw-prose-invert-links:#fff;--tw-prose-invert-bold:#fff;--tw-prose-invert-counters:#9ca3af;--tw-prose-invert-bullets:#4b5563;--tw-prose-invert-hr:#374151;--tw-prose-invert-quotes:#f3f4f6;--tw-prose-invert-quote-borders:#374151;--tw-prose-invert-captions:#9ca3af;--tw-prose-invert-kbd:#fff;--tw-prose-invert-kbd-shadows:255 255 255;--tw-prose-invert-code:#fff;--tw-prose-invert-pre-code:#d1d5db;--tw-prose-invert-pre-bg:#00000080;--tw-prose-invert-th-borders:#4b5563;--tw-prose-invert-td-borders:#374151;font-size:1rem;line-height:1.75}.prose :where(picture>img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0;margin-bottom:0}.prose :where(li):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.5em;margin-bottom:.5em}.prose :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:.375em}.prose :where(.prose>ul>li p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.75em;margin-bottom:.75em}.prose :where(.prose>ul>li>p:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ul>li>p:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em}.prose :where(.prose>ol>li>p:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ol>li>p:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em}.prose :where(ul ul,ul ol,ol ul,ol ol):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.75em;margin-bottom:.75em}.prose :where(dl):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em;margin-bottom:1.25em}.prose :where(dd):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.5em;padding-inline-start:1.625em}.prose :where(hr+*):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(h2+*):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(h3+*):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(h4+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(thead th:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:0}.prose :where(thead th:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:0}.prose :where(tbody td,tfoot td):not(:where([class~=not-prose],[class~=not-prose] *)){padding-top:.571429em;padding-inline-end:.571429em;padding-bottom:.571429em;padding-inline-start:.571429em}.prose :where(tbody td:first-child,tfoot td:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:0}.prose :where(tbody td:last-child,tfoot td:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:0}.prose :where(figure):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.prose :where(.prose>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(.prose>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0}.display-none{display:none}.focus-outline{outline-offset:1px;outline-width:2px;outline-color:rgb(var(--color-accent))}.focus-outline:focus-visible{outline-style:dashed;text-decoration-line:none}.sr-only{clip:rect(0,0,0,0);white-space:nowrap;border-width:0;width:1px;height:1px;margin:-1px;padding:0;position:absolute;overflow:hidden}.pointer-events-none{pointer-events:none}.visible{visibility:visible}.invisible{visibility:hidden}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-y-0{top:0;bottom:0}.-top-3{top:-.75rem}.-top-full{top:-100%}.left-0{left:0}.left-16{left:4rem}.right-3{right:.75rem}.z-50{z-index:50}.col-span-2{grid-column:span 2/span 2}.m-1{margin:.25rem}.mx-1{margin-left:.25rem;margin-right:.25rem}.mx-auto{margin-left:auto;margin-right:auto}.my-1{margin-top:.25rem;margin-bottom:.25rem}.my-2{margin-top:.5rem;margin-bottom:.5rem}.my-3{margin-top:.75rem;margin-bottom:.75rem}.my-4{margin-top:1rem;margin-bottom:1rem}.my-6{margin-top:1.5rem;margin-bottom:1.5rem}.my-8{margin-top:2rem;margin-bottom:2rem}.-mr-5{margin-right:-1.25rem}.mb-1{margin-bottom:.25rem}.mb-14{margin-bottom:3.5rem}.mb-2{margin-bottom:.5rem}.mb-28{margin-bottom:7rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.ml-2{margin-left:.5rem}.ml-4{margin-left:1rem}.mr-2{margin-right:.5rem}.mr-4{margin-right:1rem}.mt-2{margin-top:.5rem}.mt-4{margin-top:1rem}.mt-8{margin-top:2rem}.mt-auto{margin-top:auto}.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.flex{display:flex}.table{display:table}.grid{display:grid}.contents{display:contents}.hidden{display:none}.h-6{height:1.5rem}.w-44{width:11rem}.w-6{width:1.5rem}.w-full{width:100%}.min-w-\[1\.375rem\]{min-width:1.375rem}.max-w-3xl{max-width:48rem}.flex-1{flex:1}.rotate-90{--tw-rotate:90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}.scale-100{--tw-scale-x:1;--tw-scale-y:1;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}.scale-110{--tw-scale-x:1.1;--tw-scale-y:1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}.scale-125{--tw-scale-x:1.25;--tw-scale-y:1.25;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}.scale-75{--tw-scale-x:.75;--tw-scale-y:.75;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}.scale-90{--tw-scale-x:.9;--tw-scale-y:.9;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}.scale-95{--tw-scale-x:.95;--tw-scale-y:.95;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}.select-none{-webkit-user-select:none;user-select:none}.resize{resize:both}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-rows-4{grid-template-rows:repeat(4,minmax(0,1fr))}.flex-col{flex-direction:column}.flex-col-reverse{flex-direction:column-reverse}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-center{align-items:center}.justify-start{justify-content:flex-start}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:.25rem}.gap-6{gap:1.5rem}.gap-x-2{-moz-column-gap:.5rem;column-gap:.5rem}.gap-y-2{row-gap:.5rem}.space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-right:calc(.5rem*var(--tw-space-x-reverse));margin-left:calc(.5rem*calc(1 - var(--tw-space-x-reverse)))}.self-end{align-self:flex-end}.scroll-smooth{scroll-behavior:smooth}.whitespace-nowrap{white-space:nowrap}.text-nowrap{text-wrap:nowrap}.rounded{border-radius:.25rem}.border{border-width:1px}.border-skin-fill{--tw-border-opacity:1;border-color:rgba(var(--color-text-base),var(--tw-border-opacity))}.border-skin-line{--tw-border-opacity:1;border-color:rgba(var(--color-border),var(--tw-border-opacity))}.border-opacity-40{--tw-border-opacity:.4}.bg-skin-accent{--tw-bg-opacity:1;background-color:rgba(var(--color-accent),var(--tw-bg-opacity))}.bg-skin-card{--tw-bg-opacity:1;background-color:rgba(var(--color-card),var(--tw-bg-opacity))}.bg-skin-fill{--tw-bg-opacity:1;background-color:rgba(var(--color-fill),var(--tw-bg-opacity))}.fill-skin-accent{fill:rgb(var(--color-accent))}.fill-skin-base{fill:rgb(var(--color-text-base))}.p-2{padding:.5rem}.p-3{padding:.75rem}.p-4{padding:1rem}.px-0{padding-left:0;padding-right:0}.px-2{padding-left:.5rem;padding-right:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.pb-6{padding-bottom:1.5rem}.pl-10{padding-left:2.5rem}.pl-2{padding-left:.5rem}.pr-2{padding-right:.5rem}.pr-3{padding-right:.75rem}.text-center{text-align:center}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-9xl{font-size:8rem;line-height:1}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.lowercase{text-transform:lowercase}.capitalize{text-transform:capitalize}.italic{font-style:italic}.leading-4{line-height:1rem}.tracking-wider{letter-spacing:.05em}.text-skin-accent{--tw-text-opacity:1;color:rgba(var(--color-accent),var(--tw-text-opacity))}.text-skin-base{--tw-text-opacity:1;color:rgba(var(--color-text-base),var(--tw-text-opacity))}.text-skin-inverted{--tw-text-opacity:1;color:rgba(var(--color-fill),var(--tw-text-opacity))}.underline{text-decoration-line:underline}.decoration-dashed{text-decoration-style:dashed}.decoration-wavy{text-decoration-style:wavy}.decoration-2{text-decoration-thickness:2px}.underline-offset-4{text-underline-offset:4px}.underline-offset-8{text-underline-offset:8px}.opacity-50{opacity:.5}.opacity-75{opacity:.75}.opacity-80{opacity:.8}.filter{filter:var(--tw-blur)var(--tw-brightness)var(--tw-contrast)var(--tw-grayscale)var(--tw-hue-rotate)var(--tw-invert)var(--tw-saturate)var(--tw-sepia)var(--tw-drop-shadow)}.transition-all{transition-property:all;transition-duration:.15s;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-opacity{transition-property:opacity;transition-duration:.15s;transition-timing-function:cubic-bezier(.4,0,.2,1)}.duration-75{transition-duration:75ms}.placeholder\:italic::placeholder{font-style:italic}.placeholder\:text-opacity-75::placeholder{--tw-text-opacity:.75}.hover\:-top-0:hover{top:0}.hover\:-top-0\.5:hover{top:-.125rem}.hover\:rotate-12:hover{--tw-rotate:12deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}.hover\:rotate-6:hover{--tw-rotate:6deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}.hover\:text-skin-accent:hover{--tw-text-opacity:1;color:rgba(var(--color-accent),var(--tw-text-opacity))}.hover\:text-skin-base:hover{--tw-text-opacity:1;color:rgba(var(--color-text-base),var(--tw-text-opacity))}.hover\:underline:hover{text-decoration-line:underline}.hover\:opacity-75:hover{opacity:.75}.focus\:border-skin-accent:focus{--tw-border-opacity:1;border-color:rgba(var(--color-accent),var(--tw-border-opacity))}.focus\:outline-none:focus{outline-offset:2px;outline:2px solid #0000}.focus-visible\:no-underline:focus-visible{text-decoration-line:none}.focus-visible\:underline-offset-0:focus-visible{text-underline-offset:0px}.group:hover .group-hover\:inline-block{display:inline-block}.prose-img\:border-0 :where(img):not(:where([class~=not-prose],[class~=not-prose] *)){border-width:0}@media (min-width:640px){.sm\:static{position:static}.sm\:my-0{margin-top:0;margin-bottom:0}.sm\:my-8{margin-top:2rem;margin-bottom:2rem}.sm\:mb-3{margin-bottom:.75rem}.sm\:ml-0{margin-left:0}.sm\:ml-2{margin-left:.5rem}.sm\:mt-0{margin-top:0}.sm\:inline{display:inline}.sm\:flex{display:flex}.sm\:hidden{display:none}.sm\:w-1\/2{width:50%}.sm\:w-auto{width:auto}.sm\:scale-100{--tw-scale-x:1;--tw-scale-y:1;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}.sm\:flex-row{flex-direction:row}.sm\:flex-row-reverse{flex-direction:row-reverse}.sm\:items-end{align-items:flex-end}.sm\:items-center{align-items:center}.sm\:justify-end{justify-content:flex-end}.sm\:gap-4{gap:1rem}.sm\:gap-x-5{-moz-column-gap:1.25rem;column-gap:1.25rem}.sm\:space-x-4>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-right:calc(1rem*var(--tw-space-x-reverse));margin-left:calc(1rem*calc(1 - var(--tw-space-x-reverse)))}.sm\:p-1{padding:.25rem}.sm\:px-2{padding-left:.5rem;padding-right:.5rem}.sm\:text-3xl{font-size:1.875rem;line-height:2.25rem}}.astro-route-announcer{clip:rect(0 0 0 0);clip-path:inset(50%);white-space:nowrap;width:1px;height:1px;position:absolute;top:0;left:0;overflow:hidden}#skip-to-content:where(.astro-3ef6ksr2){z-index:50;--tw-bg-opacity:1;background-color:rgba(var(--color-accent),var(--tw-bg-opacity));--tw-text-opacity:1;color:rgba(var(--color-fill),var(--tw-text-opacity));padding:.5rem .75rem;transition-property:all;transition-duration:.15s;transition-timing-function:cubic-bezier(.4,0,.2,1);position:absolute;top:-100%;left:4rem}#skip-to-content:where(.astro-3ef6ksr2):focus{top:1rem}.nav-container:where(.astro-3ef6ksr2){flex-direction:column;justify-content:space-between;align-items:center;max-width:48rem;margin-left:auto;margin-right:auto;display:flex}@media (min-width:640px){.nav-container:where(.astro-3ef6ksr2){flex-direction:row}}.top-nav-wrap:where(.astro-3ef6ksr2){justify-content:space-between;align-items:flex-start;width:100%;padding:1rem;display:flex;position:relative}@media (min-width:640px){.top-nav-wrap:where(.astro-3ef6ksr2){align-items:center;padding-top:2rem;padding-bottom:2rem}}.logo:where(.astro-3ef6ksr2){padding-top:.25rem;padding-bottom:.25rem;font-size:1.25rem;font-weight:600;line-height:1.75rem;position:absolute}@media (min-width:640px){.logo:where(.astro-3ef6ksr2){font-size:1.5rem;line-height:2rem;position:static}}.hamburger-menu:where(.astro-3ef6ksr2){align-self:flex-end;padding:.5rem}@media (min-width:640px){.hamburger-menu:where(.astro-3ef6ksr2){display:none}}.hamburger-menu:where(.astro-3ef6ksr2) svg:where(.astro-3ef6ksr2){--tw-scale-x:1.25;--tw-scale-y:1.25;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y));fill:rgb(var(--color-text-base));width:1.5rem;height:1.5rem}nav:where(.astro-3ef6ksr2){flex-direction:column;align-items:center;width:100%;display:flex}@media (min-width:640px){nav:where(.astro-3ef6ksr2){flex-direction:row;justify-content:flex-end;margin-left:.5rem}nav:where(.astro-3ef6ksr2)>:not([hidden]):where(.astro-3ef6ksr2)~:not([hidden]):where(.astro-3ef6ksr2){--tw-space-x-reverse:0;margin-right:calc(1rem*var(--tw-space-x-reverse));margin-left:calc(1rem*calc(1 - var(--tw-space-x-reverse)))}nav:where(.astro-3ef6ksr2){padding-top:0;padding-bottom:0}}nav:where(.astro-3ef6ksr2) ul:where(.astro-3ef6ksr2){-moz-column-gap:.5rem;grid-template-rows:repeat(4,minmax(0,1fr));grid-template-columns:repeat(2,minmax(0,1fr));gap:.5rem;width:11rem;margin-top:1rem;display:grid}@media (min-width:640px){nav:where(.astro-3ef6ksr2) ul:where(.astro-3ef6ksr2){-moz-column-gap:1.25rem;gap:0 1.25rem;width:auto;margin-top:0;margin-left:0}}nav:where(.astro-3ef6ksr2) ul:where(.astro-3ef6ksr2) li:where(.astro-3ef6ksr2){grid-column:span 2/span 2;justify-content:center;align-items:center;display:flex}nav:where(.astro-3ef6ksr2) ul:where(.astro-3ef6ksr2) li:where(.astro-3ef6ksr2) a:where(.astro-3ef6ksr2){text-align:center;width:100%;padding:.75rem 1rem;font-weight:500}nav:where(.astro-3ef6ksr2) ul:where(.astro-3ef6ksr2) li:where(.astro-3ef6ksr2) a:where(.astro-3ef6ksr2):hover{--tw-text-opacity:1;color:rgba(var(--color-accent),var(--tw-text-opacity))}@media (min-width:640px){nav:where(.astro-3ef6ksr2) ul:where(.astro-3ef6ksr2) li:where(.astro-3ef6ksr2) a:where(.astro-3ef6ksr2){margin-top:0;margin-bottom:0;padding:.25rem .5rem}}nav:where(.astro-3ef6ksr2) ul:where(.astro-3ef6ksr2) li:where(.astro-3ef6ksr2):nth-last-child(2) a:where(.astro-3ef6ksr2){width:auto}nav:where(.astro-3ef6ksr2) ul:where(.astro-3ef6ksr2) li:where(.astro-3ef6ksr2):last-child,nav:where(.astro-3ef6ksr2) ul:where(.astro-3ef6ksr2) li:where(.astro-3ef6ksr2):nth-last-child(2){grid-column:span 1/span 1}nav:where(.astro-3ef6ksr2) a:where(.astro-3ef6ksr2).active{text-underline-offset:4px;text-decoration-line:underline;text-decoration-style:wavy;text-decoration-thickness:2px}nav:where(.astro-3ef6ksr2) a:where(.astro-3ef6ksr2).active svg:where(.astro-3ef6ksr2){fill:rgb(var(--color-accent))}nav:where(.astro-3ef6ksr2) button:where(.astro-3ef6ksr2){padding:.25rem}nav:where(.astro-3ef6ksr2) button:where(.astro-3ef6ksr2) svg:where(.astro-3ef6ksr2){fill:rgb(var(--color-text-base));width:1.5rem;height:1.5rem}nav:where(.astro-3ef6ksr2) button:where(.astro-3ef6ksr2) svg:where(.astro-3ef6ksr2):hover{fill:rgb(var(--color-accent))}#theme-btn:where(.astro-3ef6ksr2){padding:.75rem}@media (min-width:640px){#theme-btn:where(.astro-3ef6ksr2){padding:.25rem}}#theme-btn:where(.astro-3ef6ksr2) svg:where(.astro-3ef6ksr2){--tw-scale-x:1.25;--tw-scale-y:1.25;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}#theme-btn:where(.astro-3ef6ksr2) svg:where(.astro-3ef6ksr2):hover{--tw-rotate:12deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}@media (min-width:640px){#theme-btn:where(.astro-3ef6ksr2) svg:where(.astro-3ef6ksr2){--tw-scale-x:1;--tw-scale-y:1;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}}.menu-icon:where(.astro-3ef6ksr2) line:where(.astro-3ef6ksr2){transition-property:opacity;transition-duration:75ms;transition-timing-function:cubic-bezier(.4,0,.2,1)}.menu-icon:where(.astro-3ef6ksr2) .close:where(.astro-3ef6ksr2),.menu-icon:where(.astro-3ef6ksr2).is-active .line:where(.astro-3ef6ksr2){opacity:0}.menu-icon:where(.astro-3ef6ksr2).is-active .close:where(.astro-3ef6ksr2){opacity:1}.social-icons:where(.astro-upu6fzxr){flex-wrap:wrap;justify-content:center;gap:.25rem}.link-button:where(.astro-upu6fzxr){padding:.5rem}.link-button:where(.astro-upu6fzxr):hover{--tw-rotate:6deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}@media (min-width:640px){.link-button:where(.astro-upu6fzxr){padding:.25rem}}footer:where(.astro-sz7xmlte){width:100%}.footer-wrapper:where(.astro-sz7xmlte){flex-direction:column;justify-content:space-between;align-items:center;padding-top:1.5rem;padding-bottom:1.5rem;display:flex}@media (min-width:640px){.footer-wrapper:where(.astro-sz7xmlte){flex-direction:row-reverse;padding-top:1rem;padding-bottom:1rem}}.link-button:where(.astro-sz7xmlte){margin-top:.25rem;margin-bottom:.25rem;padding:.5rem}.link-button:where(.astro-sz7xmlte):hover{--tw-rotate:6deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}.link-button:where(.astro-sz7xmlte) svg:where(.astro-sz7xmlte){--tw-scale-x:1.25;--tw-scale-y:1.25;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}.copyright-wrapper:where(.astro-sz7xmlte){white-space:nowrap;flex-direction:column;align-items:center;margin-top:.5rem;margin-bottom:.5rem;display:flex}@media (min-width:640px){.copyright-wrapper:where(.astro-sz7xmlte){flex-direction:row}}.separator:where(.astro-sz7xmlte){display:none}@media (min-width:640px){.separator:where(.astro-sz7xmlte){display:inline}}#main-content:where(.astro-hsp6otuf){width:100%;max-width:48rem;margin-left:auto;margin-right:auto;padding-bottom:1rem;padding-left:1rem;padding-right:1rem}#main-content:where(.astro-hsp6otuf) h1:where(.astro-hsp6otuf){font-size:1.5rem;font-weight:600;line-height:2rem}@media (min-width:640px){#main-content:where(.astro-hsp6otuf) h1:where(.astro-hsp6otuf){font-size:1.875rem;line-height:2.25rem}}#main-content:where(.astro-hsp6otuf) p:where(.astro-hsp6otuf){margin-top:.5rem;margin-bottom:1.5rem;font-style:italic}.breadcrumb:where(.astro-ilhxcym7){width:100%;max-width:48rem;margin:2rem auto .25rem;padding-left:1rem;padding-right:1rem}.breadcrumb:where(.astro-ilhxcym7) ul:where(.astro-ilhxcym7) li:where(.astro-ilhxcym7){display:inline}.breadcrumb:where(.astro-ilhxcym7) ul:where(.astro-ilhxcym7) li:where(.astro-ilhxcym7) a:where(.astro-ilhxcym7){text-transform:capitalize;opacity:.7}.breadcrumb:where(.astro-ilhxcym7) ul:where(.astro-ilhxcym7) li:where(.astro-ilhxcym7) span:where(.astro-ilhxcym7){opacity:.7}.breadcrumb:where(.astro-ilhxcym7) ul:where(.astro-ilhxcym7) li:where(.astro-ilhxcym7):not(:last-child) a:where(.astro-ilhxcym7):hover{opacity:1}a:where(.astro-blwjyjpt){text-decoration-line:underline;text-decoration-style:dashed;position:relative}a:where(.astro-blwjyjpt):hover{--tw-text-opacity:1;color:rgba(var(--color-accent),var(--tw-text-opacity));top:-.125rem}a:where(.astro-blwjyjpt):focus-visible{padding:.25rem}a:where(.astro-blwjyjpt) svg:where(.astro-blwjyjpt){--tw-scale-x:.95;--tw-scale-y:.95;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y));--tw-text-opacity:1;color:rgba(var(--color-text-base),var(--tw-text-opacity));opacity:.8;width:1.5rem;height:1.5rem;margin-right:-1.25rem}.group:where(.astro-blwjyjpt):hover a:where(.astro-blwjyjpt) svg:where(.astro-blwjyjpt){fill:rgb(var(--color-accent))}@keyframes astroFadeInOut{0%{opacity:1}to{opacity:0}}@keyframes astroFadeIn{0%{opacity:0}}@keyframes astroFadeOut{to{opacity:0}}@keyframes astroSlideFromRight{0%{transform:translate(100%)}}@keyframes astroSlideFromLeft{0%{transform:translate(-100%)}}@keyframes astroSlideToRight{to{transform:translate(100%)}}@keyframes astroSlideToLeft{to{transform:translate(-100%)}}@media (prefers-reduced-motion){::view-transition-group(*){animation:none!important}::view-transition-old(*){animation:none!important}::view-transition-new(*){animation:none!important}[data-astro-transition-scope]{animation:none!important}}.pagination-wrapper:where(.astro-d776pwuy){justify-content:center;margin-top:auto;margin-bottom:2rem;display:flex}.disabled:where(.astro-d776pwuy){pointer-events:none;-webkit-user-select:none;user-select:none;opacity:.5}.disabled:where(.astro-d776pwuy):hover{--tw-text-opacity:1;color:rgba(var(--color-text-base),var(--tw-text-opacity))}.group:where(.astro-d776pwuy):hover .disabled:where(.astro-d776pwuy){fill:rgb(var(--color-text-base))}.group:where(.astro-d776pwuy):hover .disabled-svg:where(.astro-d776pwuy){fill:rgb(var(--color-text-base))!important}.social-icons:where(.astro-wkojbtzc){flex-flow:column wrap;justify-content:center;align-items:center;gap:.25rem;display:flex}@media (min-width:640px){.social-icons:where(.astro-wkojbtzc){align-items:flex-start}}.link-button:where(.astro-wkojbtzc){--tw-scale-x:.9;--tw-scale-y:.9;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y));padding:.5rem}.link-button:where(.astro-wkojbtzc):hover{--tw-rotate:6deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}@media (min-width:640px){.link-button:where(.astro-wkojbtzc){padding:.25rem}}main:where(.astro-vj4tpspi){width:100%;max-width:48rem;margin-left:auto;margin-right:auto;padding-bottom:3rem;padding-left:1rem;padding-right:1rem}.post-title:where(.astro-vj4tpspi){--tw-text-opacity:1;color:rgba(var(--color-accent),var(--tw-text-opacity));font-size:1.5rem;font-weight:600;line-height:2rem}</style><script type="module" src="/astro/static/hoisted.sO-65EBM.js"></script><style>[data-astro-transition-scope=astro-plk3gbjq-1]{view-transition-name:mybatis}@layer astro{::view-transition-old(mybatis){animation-name:astroFadeOut;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}::view-transition-new(mybatis){animation-name:astroFadeIn;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition=back]::view-transition-old(mybatis){animation-name:astroFadeOut;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition=back]::view-transition-new(mybatis){animation-name:astroFadeIn;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-plk3gbjq-1],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-plk3gbjq-1]{animation-name:astroFadeOut;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-plk3gbjq-1],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-plk3gbjq-1]{animation-name:astroFadeIn;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-plk3gbjq-1],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-plk3gbjq-1]{animation-name:astroFadeOut;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-plk3gbjq-1],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-plk3gbjq-1]{animation-name:astroFadeIn;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}</style><style>[data-astro-transition-scope=astro-36ssibgs-2]{view-transition-name:java}@layer astro{::view-transition-old(java){animation-name:astroFadeOut;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}::view-transition-new(java){animation-name:astroFadeIn;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition=back]::view-transition-old(java){animation-name:astroFadeOut;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition=back]::view-transition-new(java){animation-name:astroFadeIn;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-36ssibgs-2],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-36ssibgs-2]{animation-name:astroFadeOut;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-36ssibgs-2],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-36ssibgs-2]{animation-name:astroFadeIn;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-36ssibgs-2],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-36ssibgs-2]{animation-name:astroFadeOut;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-36ssibgs-2],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-36ssibgs-2]{animation-name:astroFadeIn;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}</style><style>[data-astro-transition-scope=astro-36ssibgs-3]{view-transition-name:mybatis}@layer astro{::view-transition-old(mybatis){animation-name:astroFadeOut;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}::view-transition-new(mybatis){animation-name:astroFadeIn;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition=back]::view-transition-old(mybatis){animation-name:astroFadeOut;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition=back]::view-transition-new(mybatis){animation-name:astroFadeIn;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-36ssibgs-3],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-36ssibgs-3]{animation-name:astroFadeOut;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-36ssibgs-3],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-36ssibgs-3]{animation-name:astroFadeIn;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-36ssibgs-3],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-36ssibgs-3]{animation-name:astroFadeOut;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-36ssibgs-3],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-36ssibgs-3]{animation-name:astroFadeIn;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}</style></head> <body>  <header class="astro-3ef6ksr2"> <a id="skip-to-content" href="#main-content" class="astro-3ef6ksr2">Skip to content</a> <div class="astro-3ef6ksr2 nav-container"> <div class="astro-3ef6ksr2 top-nav-wrap"> <a href="/astro" class="astro-3ef6ksr2 logo whitespace-nowrap"> 知道的越多，才知知道的越少 </a> <nav id="nav-menu" class="astro-3ef6ksr2"> <button class="astro-3ef6ksr2 focus-outline hamburger-menu" aria-label="Open Menu" aria-expanded="false" aria-controls="menu-items"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="astro-3ef6ksr2 menu-icon"> <line x1="7" y1="12" x2="21" y2="12" class="line astro-3ef6ksr2"></line> <line x1="3" y1="6" x2="21" y2="6" class="line astro-3ef6ksr2"></line> <line x1="12" y1="18" x2="21" y2="18" class="line astro-3ef6ksr2"></line> <line x1="18" y1="6" x2="6" y2="18" class="astro-3ef6ksr2 close"></line> <line x1="6" y1="6" x2="18" y2="18" class="astro-3ef6ksr2 close"></line> </svg> </button> <ul id="menu-items" class="astro-3ef6ksr2 display-none sm:flex"> <li class="astro-3ef6ksr2"> <a href="/astro/posts/" class="astro-3ef6ksr2">
Posts
</a> </li> <li class="astro-3ef6ksr2"> <a href="/astro/tags/" class="astro-3ef6ksr2">
Tags
</a> </li> <!-- <li>
            <a href="/about/" class={activeNav === "about" ? "active" : ""}>
              About
            </a>
          </li> --> <li class="astro-3ef6ksr2"> <a href="/astro/search/" class="astro-3ef6ksr2 focus-outline flex group hover:text-skin-accent inline-block p-3 sm:p-1" aria-label="search" title="Search"> <svg xmlns="http://www.w3.org/2000/svg" class="astro-3ef6ksr2 scale-125 sm:scale-100"><path d="M19.023 16.977a35.13 35.13 0 0 1-1.367-1.384c-.372-.378-.596-.653-.596-.653l-2.8-1.337A6.962 6.962 0 0 0 16 9c0-3.859-3.14-7-7-7S2 5.141 2 9s3.14 7 7 7c1.763 0 3.37-.66 4.603-1.739l1.337 2.8s.275.224.653.596c.387.363.896.854 1.384 1.367l1.358 1.392.604.646 2.121-2.121-.646-.604c-.379-.372-.885-.866-1.391-1.36zM9 14c-2.757 0-5-2.243-5-5s2.243-5 5-5 5 2.243 5 5-2.243 5-5 5z" class="astro-3ef6ksr2"></path> </svg> <span class="astro-3ef6ksr2 sr-only">Search</span> </a> </li>  </ul> </nav> </div> </div> <div class="max-w-3xl mx-auto px-4"> <hr class="border-skin-line" aria-hidden="true"> </div> </header>   <div class="astro-vj4tpspi flex justify-start max-w-3xl mx-auto px-2 w-full"> <button class="astro-vj4tpspi flex focus-outline hover:opacity-75 mb-2 mt-8" onclick='history.length===1?window.location="/":history.back();
'> <svg xmlns="http://www.w3.org/2000/svg" class="astro-vj4tpspi"><path d="M13.293 6.293 7.586 12l5.707 5.707 1.414-1.414L10.414 12l4.293-4.293z" class="astro-vj4tpspi"></path> </svg><span class="astro-vj4tpspi">Go back</span> </button> </div> <main id="main-content" class="astro-vj4tpspi"> <h1 class="astro-vj4tpspi post-title" data-astro-transition-scope="astro-plk3gbjq-1">Mybatis</h1> <div class="astro-vj4tpspi flex items-center my-2 opacity-80 space-x-2"><svg xmlns="http://www.w3.org/2000/svg" class="inline-block fill-skin-base h-6 min-w-[1.375rem] scale-100 w-6" aria-hidden="true"><path d="M7 11h2v2H7zm0 4h2v2H7zm4-4h2v2h-2zm0 4h2v2h-2zm4-4h2v2h-2zm0 4h2v2h-2z"></path><path d="M5 22h14c1.103 0 2-.897 2-2V6c0-1.103-.897-2-2-2h-2V2h-2v2H9V2H7v2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2zM19 8l.001 12H5V8h14z"></path></svg><span class="italic text-base">Updated:</span><span class="italic text-base"><time datetime="2024-02-22T00:37:28.000Z">Feb 22, 2024</time><span aria-hidden="true"> | </span><span class="sr-only">&nbsp;at&nbsp;</span><span class="text-nowrap">12:37 AM</span></span></div> <article id="article" role="article" class="astro-vj4tpspi max-w-3xl mx-auto mt-8 prose"> <h2 id="table-of-contents">Table of contents</h2>
<p></p><details><summary>Open Table of contents</summary><p></p>
<ul>
<li><a href="#mybatis%E4%BD%BF%E7%94%A8">Mybatis使用</a>
<ul>
<li><a href="#spring%E6%95%B4%E5%90%88mybatis-%E5%AE%9E%E7%8E%B0">spring整合mybatis 实现</a></li>
</ul>
</li>
<li><a href="#sqlsessionfactorybean%E7%9A%84%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86">SqlSessionFactoryBean的底层原理</a></li>
<li><a href="#factorybean%E7%9A%84%E4%BD%9C%E7%94%A8%E5%92%8C%E5%BA%95%E5%B1%82%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86">FactoryBean的作用和底层工作原理</a></li>
<li><a href="#importbeandefinitionregistrar%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86">ImportBeanDefinitionRegistrar底层原理</a></li>
<li><a href="#mapperscannerconfigurer%E5%BA%95%E5%B1%82%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90">MapperScannerConfigurer底层源码分析</a></li>
<li><a href="#mapperscan%E6%B3%A8%E8%A7%A3%E7%9A%84%E5%BA%95%E5%B1%82%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90">@MapperScan注解的底层源码分析</a></li>
<li><a href="#spring%E6%95%B4%E5%90%88mybatis%E7%9A%84%E5%BA%95%E5%B1%82%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90">Spring整合Mybatis的底层源码分析</a></li>
<li><a href="#springboot%E6%95%B4%E5%90%88mybatis%E7%9A%84%E5%BA%95%E5%B1%82%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90">SpringBoot整合Mybatis的底层源码分析</a></li>
</ul>
<p></p></details><p></p>
<h2 id="mybatis使用">Mybatis使用</h2>
<p>ORM框架：Object Relational Mapping。用于实现面向对象编程语言里不同类型系统的数据之间的转换。</p>
<ul>
<li>
<p>添加依赖</p>
<ul>
<li>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#56B6C2">&lt;</span><span style="color:#E06C75">dependency</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">    &lt;</span><span style="color:#E06C75">groupId</span><span style="color:#56B6C2">&gt;</span><span style="color:#E5C07B">org</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">mybatis</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">spring</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">boot</span><span style="color:#56B6C2">&lt;/</span><span style="color:#E06C75">groupId</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">    &lt;</span><span style="color:#E06C75">artifactId</span><span style="color:#56B6C2">&gt;</span><span style="color:#E06C75">mybatis</span><span style="color:#56B6C2">-</span><span style="color:#E06C75">spring</span><span style="color:#56B6C2">-</span><span style="color:#E06C75">boot</span><span style="color:#56B6C2">-</span><span style="color:#E06C75">starter</span><span style="color:#56B6C2">&lt;/</span><span style="color:#E06C75">artifactId</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">    &lt;</span><span style="color:#E06C75">version</span><span style="color:#56B6C2">&gt;</span><span style="color:#D19A66">2.0</span><span style="color:#ABB2BF">.</span><span style="color:#fff">1</span><span style="color:#56B6C2">&lt;/</span><span style="color:#E06C75">version</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">&lt;/</span><span style="color:#E06C75">dependency</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"></span></code></pre>
</li>
</ul>
</li>
<li>
<p>配置文件中配置mybatis的mapper文件位置。</p>
<ul>
<li>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#E5C07B">mybatis</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">mapper</span><span style="color:#56B6C2">-</span><span style="color:#E06C75">locations</span><span style="color:#56B6C2">=</span><span style="color:#E06C75">classpath</span><span style="color:#C678DD">:</span><span style="color:#E06C75">mapper</span><span style="color:#7F848E;font-style:italic">/*.xml</span></span>
<span class="line"></span></code></pre>
</li>
</ul>
</li>
<li>
<p>pom.xml 设置springboot在包中扫描xml文件。</p>
</li>
<li>
<p>启动类添加注解用于给出需要扫描的mapper文件路径@MapperScan(“xxx.xxx.xxx.xxx”)。</p>
</li>
<li>
<p>逆向工程依赖</p>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#56B6C2">&lt;</span><span style="color:#E06C75">plugin</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">    &lt;</span><span style="color:#E06C75">groupId</span><span style="color:#56B6C2">&gt;</span><span style="color:#E5C07B">org</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">mybatis</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">generator</span><span style="color:#56B6C2">&lt;/</span><span style="color:#E06C75">groupId</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">    &lt;</span><span style="color:#E06C75">artifactId</span><span style="color:#56B6C2">&gt;</span><span style="color:#E06C75">mybatis</span><span style="color:#56B6C2">-</span><span style="color:#E06C75">generator</span><span style="color:#56B6C2">-</span><span style="color:#E06C75">maven</span><span style="color:#56B6C2">-</span><span style="color:#E06C75">plugin</span><span style="color:#56B6C2">&lt;/</span><span style="color:#E06C75">artifactId</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">    &lt;</span><span style="color:#E06C75">version</span><span style="color:#56B6C2">&gt;</span><span style="color:#D19A66">1.4</span><span style="color:#ABB2BF">.</span><span style="color:#fff">1</span><span style="color:#56B6C2">&lt;/</span><span style="color:#E06C75">version</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">    &lt;</span><span style="color:#E06C75">configuration</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75">允许移动生成的文件 </span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;</span><span style="color:#E06C75">verbose</span><span style="color:#56B6C2">&gt;</span><span style="color:#D19A66">true</span><span style="color:#56B6C2">&lt;/</span><span style="color:#E06C75">verbose</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 是否覆盖 </span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;</span><span style="color:#E06C75">overwrite</span><span style="color:#56B6C2">&gt;</span><span style="color:#D19A66">true</span><span style="color:#56B6C2">&lt;/</span><span style="color:#E06C75">overwrite</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 自动生成的配置文件路径。启动插件时，插件会根据这里配置的路径去找到generatorConfig</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">xml配置文件</span><span style="color:#E06C75">，</span></span>
<span class="line"><span style="color:#E06C75">        根据配置文件里的配置，去自动生成Mapper接口（可以理解为Dao层）、实体类、</span><span style="color:#E5C07B">Mapper</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">xml文件</span></span>
<span class="line"><span style="color:#ABB2BF">        --</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;</span><span style="color:#E06C75">configurationFile</span><span style="color:#56B6C2">&gt;</span><span style="color:#E06C75">src</span><span style="color:#56B6C2">/</span><span style="color:#E06C75">main</span><span style="color:#56B6C2">/</span><span style="color:#E06C75">resources</span><span style="color:#56B6C2">/</span><span style="color:#E5C07B">GeneratorConfig</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">xml</span><span style="color:#56B6C2">&lt;/</span><span style="color:#E06C75">configurationFile</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">    &lt;/</span><span style="color:#E06C75">configuration</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">    &lt;</span><span style="color:#E06C75">dependencies</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;</span><span style="color:#E06C75">dependency</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">groupId</span><span style="color:#56B6C2">&gt;</span><span style="color:#E06C75">mysql</span><span style="color:#56B6C2">&lt;/</span><span style="color:#E06C75">groupId</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">artifactId</span><span style="color:#56B6C2">&gt;</span><span style="color:#E06C75">mysql</span><span style="color:#56B6C2">-</span><span style="color:#E06C75">connector</span><span style="color:#56B6C2">-</span><span style="color:#E06C75">java</span><span style="color:#56B6C2">&lt;/</span><span style="color:#E06C75">artifactId</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">version</span><span style="color:#56B6C2">&gt;</span><span style="color:#D19A66">8.0</span><span style="color:#ABB2BF">.</span><span style="color:#fff">29</span><span style="color:#56B6C2">&lt;/</span><span style="color:#E06C75">version</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;/</span><span style="color:#E06C75">dependency</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;</span><span style="color:#E06C75">dependency</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">groupId</span><span style="color:#56B6C2">&gt;</span><span style="color:#E5C07B">org</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">mybatis</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">generator</span><span style="color:#56B6C2">&lt;/</span><span style="color:#E06C75">groupId</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">artifactId</span><span style="color:#56B6C2">&gt;</span><span style="color:#E06C75">mybatis</span><span style="color:#56B6C2">-</span><span style="color:#E06C75">generator</span><span style="color:#56B6C2">-</span><span style="color:#E06C75">core</span><span style="color:#56B6C2">&lt;/</span><span style="color:#E06C75">artifactId</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">version</span><span style="color:#56B6C2">&gt;</span><span style="color:#D19A66">1.4</span><span style="color:#ABB2BF">.</span><span style="color:#fff">1</span><span style="color:#56B6C2">&lt;/</span><span style="color:#E06C75">version</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;/</span><span style="color:#E06C75">dependency</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2">    &lt;/</span><span style="color:#E06C75">dependencies</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">    &lt;</span><span style="color:#E06C75">executions</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;</span><span style="color:#E06C75">execution</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">id</span><span style="color:#56B6C2">&gt;</span><span style="color:#E5C07B">Generate</span><span style="color:#E5C07B"> MyBatis</span><span style="color:#E5C07B"> Artifacts</span><span style="color:#56B6C2">&lt;/</span><span style="color:#E06C75">id</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">phase</span><span style="color:#56B6C2">&gt;</span><span style="color:#C678DD">package&lt;/phase&gt;</span></span>
<span class="line"><span style="color:#C678DD">            &lt;goals&gt;</span></span>
<span class="line"><span style="color:#C678DD">                &lt;goal&gt;generate&lt;/goal&gt;</span></span>
<span class="line"><span style="color:#C678DD">            &lt;/goals&gt;</span></span>
<span class="line"><span style="color:#C678DD">        &lt;/execution&gt;</span></span>
<span class="line"><span style="color:#C678DD">    &lt;/executions&gt;</span></span>
<span class="line"><span style="color:#C678DD">&lt;/plugin&gt;</span></span>
<span class="line"></span></code></pre>
<p>generatorConfig.xml</p>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#56B6C2">&lt;</span><span style="color:#C678DD">?</span><span style="color:#E06C75">xml version</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"1.0"</span><span style="color:#E06C75"> encoding</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"UTF-8"</span><span style="color:#C678DD">?</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">&lt;!</span><span style="color:#E5C07B">DOCTYPE</span><span style="color:#E06C75"> generatorConfiguration</span></span>
<span class="line"><span style="color:#E06C75">        PUBLIC </span><span style="color:#98C379">"-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"</span></span>
<span class="line"><span style="color:#98C379">        "http://mybatis.org/dtd/mybatis-generator-config_1.0.dtd"</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">&lt;</span><span style="color:#E06C75">generatorConfiguration</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2">    &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 数据库驱动</span><span style="color:#C678DD">:</span><span style="color:#E06C75">选择你的本地硬盘上面的数据库驱动包 </span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">    &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75">    因为已经在pom</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">xml添加逆向工程插件时添加了驱动依赖</span><span style="color:#E06C75">，所以省略这一步</span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">    &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">    &lt;</span><span style="color:#E06C75">classPathEntry  location</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"C:</span><span style="color:#56B6C2">\U</span><span style="color:#98C379">sers</span><span style="color:#56B6C2">\l</span><span style="color:#98C379">enovo</span><span style="color:#56B6C2">\D</span><span style="color:#98C379">esktop</span><span style="color:#56B6C2">\S</span><span style="color:#98C379">oftware_project</span><span style="color:#56B6C2">\j</span><span style="color:#98C379">ava</span><span style="color:#56B6C2">\m</span><span style="color:#98C379">ysql-connector-java-8.0.28/mysql-connector-java-8.0.28.jar"</span><span style="color:#56B6C2">/&gt;</span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2">    &lt;</span><span style="color:#E06C75">context id</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"DB2Tables"</span><span style="color:#E06C75"> targetRuntime</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"MyBatis3"</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 实体类生成序列化属性</span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;</span><span style="color:#E06C75">plugin type</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"org.mybatis.generator.plugins.SerializablePlugin"</span><span style="color:#56B6C2">/&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 实体类重写</span><span style="color:#61AFEF">HashCode</span><span style="color:#E06C75">()和</span><span style="color:#61AFEF">equals</span><span style="color:#E06C75">()</span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;</span><span style="color:#E06C75">plugin type</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"org.mybatis.generator.plugins.EqualsHashCodePlugin"</span><span style="color:#56B6C2">/&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 实体类重写</span><span style="color:#61AFEF">toString</span><span style="color:#E06C75">() </span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;</span><span style="color:#E06C75">plugin type</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"org.mybatis.generator.plugins.ToStringPlugin"</span><span style="color:#56B6C2">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2">        &lt;</span><span style="color:#E06C75">commentGenerator</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 是否去除自动生成的注释 </span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">property name</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"suppressAllComments"</span><span style="color:#E06C75"> value</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"true"</span><span style="color:#56B6C2">/&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 生成注释是否带时间戳</span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">property name</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"suppressDate"</span><span style="color:#E06C75"> value</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"true"</span><span style="color:#56B6C2">/&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 生成的Java文件的编码格式 </span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">property name</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"javaFileEncoding"</span><span style="color:#E06C75"> value</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"utf-8"</span><span style="color:#56B6C2">/&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 数据库注释支持 </span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">property name</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"addRemarkComments"</span><span style="color:#E06C75"> value</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"true"</span><span style="color:#56B6C2">/&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 时间格式设置 </span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">property name</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"dateFormat"</span><span style="color:#E06C75"> value</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"yyyy-MM-dd HH:mm:ss"</span><span style="color:#56B6C2">/&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 格式化java代码</span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">property name</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"javaFormatter"</span><span style="color:#E06C75"> value</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"org.mybatis.generator.api.dom.DefaultJavaFormatter"</span><span style="color:#56B6C2">/&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 格式化XML代码</span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">property name</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"xmlFormatter"</span><span style="color:#E06C75"> value</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"org.mybatis.generator.api.dom.DefaultXmlFormatter"</span><span style="color:#56B6C2">/&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;/</span><span style="color:#E06C75">commentGenerator</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2">        &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 数据库连接驱动类</span><span style="color:#ABB2BF">,</span><span style="color:#E06C75">URL，用户名、密码 </span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;</span><span style="color:#E06C75">jdbcConnection driverClass</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"com.mysql.cj.jdbc.Driver"</span></span>
<span class="line"><span style="color:#E06C75">                        connectionURL</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"jdbc:mysql://119.45.27.47:3306/dms_usp?useSSL=false&amp;amp;useUnicode=true&amp;amp;characterEncoding=utf-8"</span></span>
<span class="line"><span style="color:#E06C75">                        userId</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"FordDms"</span></span>
<span class="line"><span style="color:#E06C75">                        password</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"FordDms.1234"</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">property name</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"nullCatalogMeansCurrent"</span><span style="color:#E06C75"> value</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"true"</span><span style="color:#56B6C2">/&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;/</span><span style="color:#E06C75">jdbcConnection</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2">        &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> java类型处理器：处理DB中的类型到Java中的类型 </span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;</span><span style="color:#E06C75">javaTypeResolver type</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"org.mybatis.generator.internal.types.JavaTypeResolverDefaultImpl"</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 是否有效识别DB中的BigDecimal类型 </span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">property name</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"forceBigDecimals"</span><span style="color:#E06C75"> value</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"true"</span><span style="color:#56B6C2">/&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;/</span><span style="color:#E06C75">javaTypeResolver</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2">        &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 生成Domain模型：包名(targetPackage)、位置(targetProject) </span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;</span><span style="color:#E06C75">javaModelGenerator targetPackage</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"com.yonyou.dms.web.entity"</span><span style="color:#E06C75"> targetProject</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"E:</span><span style="color:#56B6C2">\w</span><span style="color:#98C379">orkspace</span><span style="color:#56B6C2">\P</span><span style="color:#98C379">arent</span><span style="color:#56B6C2">\L</span><span style="color:#98C379">ogin</span><span style="color:#56B6C2">\s</span><span style="color:#98C379">rc</span><span style="color:#56B6C2">\m</span><span style="color:#98C379">ain</span><span style="color:#56B6C2">\j</span><span style="color:#98C379">ava"</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 在targetPackage的基础上，根据数据库的schema再生成一层package，最终生成的类放在这个package下，默认为false </span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">property name</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"enableSubPackages"</span><span style="color:#E06C75"> value</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"true"</span><span style="color:#56B6C2">/&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 设置是否在getter方法中，对</span><span style="color:#61AFEF">String类型字段调用trim</span><span style="color:#E06C75">()方法</span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">property name</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"trimStrings"</span><span style="color:#E06C75"> value</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"true"</span><span style="color:#56B6C2">/&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;/</span><span style="color:#E06C75">javaModelGenerator</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2">        &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 生成xml映射文件：包名(targetPackage)、位置(targetProject) </span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;</span><span style="color:#E06C75">sqlMapGenerator targetPackage</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"mapper"</span><span style="color:#E06C75"> targetProject</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"E:</span><span style="color:#56B6C2">\w</span><span style="color:#98C379">orkspace</span><span style="color:#56B6C2">\P</span><span style="color:#98C379">arent</span><span style="color:#56B6C2">\L</span><span style="color:#98C379">ogin</span><span style="color:#56B6C2">\s</span><span style="color:#98C379">rc</span><span style="color:#56B6C2">\m</span><span style="color:#98C379">ain</span><span style="color:#56B6C2">\r</span><span style="color:#98C379">esources"</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">property name</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"enableSubPackages"</span><span style="color:#E06C75"> value</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"true"</span><span style="color:#56B6C2">/&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;/</span><span style="color:#E06C75">sqlMapGenerator</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2">        &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75"> 生成DAO接口：包名(targetPackage)、位置(targetProject) </span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;</span><span style="color:#E06C75">javaClientGenerator type</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"XMLMAPPER"</span><span style="color:#E06C75"> targetPackage</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"com.yonyou.dms.web.dao"</span></span>
<span class="line"><span style="color:#E06C75">                             targetProject</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"E:</span><span style="color:#56B6C2">\w</span><span style="color:#98C379">orkspace</span><span style="color:#56B6C2">\P</span><span style="color:#98C379">arent</span><span style="color:#56B6C2">\L</span><span style="color:#98C379">ogin</span><span style="color:#56B6C2">\s</span><span style="color:#98C379">rc</span><span style="color:#56B6C2">\m</span><span style="color:#98C379">ain</span><span style="color:#56B6C2">\j</span><span style="color:#98C379">ava"</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">property name</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"enableSubPackages"</span><span style="color:#E06C75"> value</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"true"</span><span style="color:#56B6C2">/&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;/</span><span style="color:#E06C75">javaClientGenerator</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2">        &lt;</span><span style="color:#E06C75">table tableName</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"tc_menu_action"</span><span style="color:#E06C75"> domainObjectName</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"MenuAction"</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75">            若数据库中某个属性类型为text或类似类型，可能会发生无法生成这个属性，此时可以在这里指定转换类型为VARCHAR</span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">columnOverride column</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"teacher_name"</span><span style="color:#E06C75"> jdbcType</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"VARCHAR"</span><span style="color:#56B6C2"> /&gt;</span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">&lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#E06C75">        　　table标签下的设置属性useActualColumnNames用于指定生成实体类时是否使用实际的列名作为实体类的属性名，取值true或false。</span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">&lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#D19A66">        　　true</span><span style="color:#E06C75">：</span><span style="color:#E5C07B">MyBatis</span><span style="color:#E06C75"> Generator会使用数据库中实际的字段名字作为生成的实体类的属性名。</span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">&lt;!</span><span style="color:#ABB2BF">--</span><span style="color:#D19A66">        　　false</span><span style="color:#E06C75">：这是默认值。如果设置为false</span><span style="color:#ABB2BF">,</span><span style="color:#E06C75">则MyBatis </span><span style="color:#E5C07B">Generator会将数据库中实际的字段名字转换为Camel</span><span style="color:#E06C75"> Case风格作为生成的实体类的属性名。</span><span style="color:#ABB2BF">--</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">            &lt;</span><span style="color:#E06C75">property name</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"useActualColumnNames"</span><span style="color:#E06C75"> value</span><span style="color:#56B6C2">=</span><span style="color:#98C379">"false"</span><span style="color:#56B6C2"> /&gt;</span></span>
<span class="line"><span style="color:#56B6C2">        &lt;/</span><span style="color:#E06C75">table</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">    &lt;/</span><span style="color:#E06C75">context</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"><span style="color:#56B6C2">&lt;/</span><span style="color:#E06C75">generatorConfiguration</span><span style="color:#56B6C2">&gt;</span></span>
<span class="line"></span></code></pre>
</li>
</ul>
<p>先执行二级缓存，再执行一级缓存。</p>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#C678DD">public</span><span style="color:#56B6C2"> &lt;</span><span style="color:#E06C75">E</span><span style="color:#56B6C2">&gt;</span><span style="color:#E5C07B"> List</span><span style="color:#56B6C2">&lt;</span><span style="color:#E06C75">E</span><span style="color:#56B6C2">&gt;</span><span style="color:#61AFEF"> query</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">MappedStatement</span><span style="color:#E06C75"> ms</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> Object</span><span style="color:#E06C75"> parameterObject</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> RowBounds</span><span style="color:#E06C75"> rowBounds</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> ResultHandler</span><span style="color:#E06C75"> resultHandler) throws SQLException {</span></span>
<span class="line"><span style="color:#E5C07B">    BoundSql</span><span style="color:#E06C75"> boundSql </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> ms</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getBoundSql</span><span style="color:#ABB2BF">(parameterObject);</span></span>
<span class="line"><span style="color:#E5C07B">    CacheKey</span><span style="color:#E06C75"> key </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">createCacheKey</span><span style="color:#ABB2BF">(ms, parameterObject, rowBounds, boundSql);</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">query</span><span style="color:#ABB2BF">(ms, parameterObject, rowBounds, resultHandler, key, boundSql);</span></span>
<span class="line"><span style="color:#E06C75">}</span></span>
<span class="line"></span></code></pre>
<p>mybatis调用query时如何使用缓存，createCacheKey生成key。</p>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#C678DD">public</span><span style="color:#E5C07B"> CacheKey</span><span style="color:#61AFEF"> createCacheKey</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">MappedStatement</span><span style="color:#E06C75"> ms</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> Object</span><span style="color:#E06C75"> parameterObject</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> RowBounds</span><span style="color:#E06C75"> rowBounds</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> BoundSql</span><span style="color:#E06C75"> boundSql) {</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#E06C75"> (</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">closed</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#C678DD">        throw</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> ExecutorException</span><span style="color:#E06C75">(</span><span style="color:#98C379">"Executor was closed."</span><span style="color:#E06C75">)</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E06C75">    } </span><span style="color:#C678DD">else</span><span style="color:#E06C75"> {</span></span>
<span class="line"><span style="color:#E5C07B">        CacheKey</span><span style="color:#E06C75"> cacheKey </span><span style="color:#56B6C2">=</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> CacheKey</span><span style="color:#E06C75">()</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E5C07B">        cacheKey</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">update</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">ms</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getId</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#E5C07B">        cacheKey</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">update</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">rowBounds</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getOffset</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#E5C07B">        cacheKey</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">update</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">rowBounds</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getLimit</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#E5C07B">        cacheKey</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">update</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">boundSql</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getSql</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#E5C07B">        List</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">ParameterMapping</span><span style="color:#ABB2BF">&gt;</span><span style="color:#E06C75"> parameterMappings </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> boundSql</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getParameterMappings</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">        TypeHandlerRegistry</span><span style="color:#E06C75"> typeHandlerRegistry </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> ms</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getConfiguration</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">getTypeHandlerRegistry</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">        Iterator</span><span style="color:#E06C75"> var8 </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> parameterMappings</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">iterator</span><span style="color:#ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">        while</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">var8</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">hasNext</span><span style="color:#ABB2BF">()</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E5C07B">            ParameterMapping</span><span style="color:#E06C75"> parameterMapping </span><span style="color:#56B6C2">=</span><span style="color:#E06C75"> (ParameterMapping)</span><span style="color:#E5C07B">var8</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">next</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#C678DD">            if</span><span style="color:#E06C75"> (</span><span style="color:#E5C07B">parameterMapping</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getMode</span><span style="color:#ABB2BF">()</span><span style="color:#56B6C2"> !=</span><span style="color:#E5C07B"> ParameterMode</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">OUT</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E5C07B">                String</span><span style="color:#E06C75"> propertyName </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> parameterMapping</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getProperty</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">                Object</span><span style="color:#E06C75"> value</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">                if</span><span style="color:#E06C75"> (</span><span style="color:#E5C07B">boundSql</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">hasAdditionalParameter</span><span style="color:#ABB2BF">(propertyName)</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E06C75">                    value </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> boundSql</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getAdditionalParameter</span><span style="color:#ABB2BF">(propertyName);</span></span>
<span class="line"><span style="color:#E06C75">                } </span><span style="color:#C678DD">else</span><span style="color:#C678DD"> if</span><span style="color:#E06C75"> (parameterObject </span><span style="color:#56B6C2">==</span><span style="color:#D19A66"> null</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E06C75">                    value </span><span style="color:#56B6C2">=</span><span style="color:#D19A66"> null</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E06C75">                } </span><span style="color:#C678DD">else</span><span style="color:#C678DD"> if</span><span style="color:#E06C75"> (</span><span style="color:#E5C07B">typeHandlerRegistry</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">hasTypeHandler</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">parameterObject</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getClass</span><span style="color:#ABB2BF">())</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E06C75">                    value </span><span style="color:#56B6C2">=</span><span style="color:#E06C75"> parameterObject</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E06C75">                } </span><span style="color:#C678DD">else</span><span style="color:#E06C75"> {</span></span>
<span class="line"><span style="color:#E5C07B">                    MetaObject</span><span style="color:#E06C75"> metaObject </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">configuration</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">newMetaObject</span><span style="color:#ABB2BF">(parameterObject);</span></span>
<span class="line"><span style="color:#E06C75">                    value </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> metaObject</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getValue</span><span style="color:#ABB2BF">(propertyName);</span></span>
<span class="line"><span style="color:#E06C75">                }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B">                cacheKey</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">update</span><span style="color:#ABB2BF">(value);</span></span>
<span class="line"><span style="color:#E06C75">            }</span></span>
<span class="line"><span style="color:#E06C75">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#E06C75"> (</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">configuration</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getEnvironment</span><span style="color:#ABB2BF">()</span><span style="color:#56B6C2"> !=</span><span style="color:#D19A66"> null</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E5C07B">            cacheKey</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">update</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">configuration</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getEnvironment</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">getId</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#E06C75">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E06C75"> cacheKey</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E06C75">    }</span></span>
<span class="line"><span style="color:#E06C75">}</span></span>
<span class="line"></span></code></pre>
<p>执行查询方法。</p>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#C678DD">public</span><span style="color:#56B6C2"> &lt;</span><span style="color:#E06C75">E</span><span style="color:#56B6C2">&gt;</span><span style="color:#E5C07B"> List</span><span style="color:#56B6C2">&lt;</span><span style="color:#E06C75">E</span><span style="color:#56B6C2">&gt;</span><span style="color:#61AFEF"> query</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">MappedStatement</span><span style="color:#E06C75"> ms</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> Object</span><span style="color:#E06C75"> parameterObject</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> RowBounds</span><span style="color:#E06C75"> rowBounds</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> ResultHandler</span><span style="color:#E06C75"> resultHandler</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> CacheKey</span><span style="color:#E06C75"> key</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> BoundSql</span><span style="color:#E06C75"> boundSql) throws SQLException {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // 查询时先从二级缓存中获取数据</span></span>
<span class="line"><span style="color:#E5C07B">    Cache</span><span style="color:#E06C75"> cache </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> ms</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getCache</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#E06C75"> (cache </span><span style="color:#56B6C2">!=</span><span style="color:#D19A66"> null</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">flushCacheIfRequired</span><span style="color:#ABB2BF">(ms);</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#E06C75"> (</span><span style="color:#E5C07B">ms</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">isUseCache</span><span style="color:#ABB2BF">()</span><span style="color:#56B6C2"> &amp;&amp;</span><span style="color:#E06C75"> resultHandler </span><span style="color:#56B6C2">==</span><span style="color:#D19A66"> null</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E5C07B">            this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">ensureNoOutParams</span><span style="color:#ABB2BF">(ms, boundSql);</span></span>
<span class="line"><span style="color:#E5C07B">            List</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">E</span><span style="color:#ABB2BF">&gt;</span><span style="color:#E06C75"> list </span><span style="color:#56B6C2">=</span><span style="color:#E06C75"> (List)</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">tcm</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getObject</span><span style="color:#ABB2BF">(cache, key);</span></span>
<span class="line"><span style="color:#C678DD">            if</span><span style="color:#E06C75"> (list </span><span style="color:#56B6C2">==</span><span style="color:#D19A66"> null</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E06C75">                list </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">delegate</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">query</span><span style="color:#ABB2BF">(ms, parameterObject, rowBounds, resultHandler, key, boundSql);</span></span>
<span class="line"><span style="color:#E5C07B">                this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">tcm</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">putObject</span><span style="color:#ABB2BF">(cache, key, list);</span></span>
<span class="line"><span style="color:#E06C75">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">            return</span><span style="color:#E06C75"> list</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E06C75">        }</span></span>
<span class="line"><span style="color:#E06C75">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">delegate</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">query</span><span style="color:#ABB2BF">(ms, parameterObject, rowBounds, resultHandler, key, boundSql);</span></span>
<span class="line"><span style="color:#E06C75">}</span></span>
<span class="line"></span></code></pre>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#C678DD">public</span><span style="color:#56B6C2"> &lt;</span><span style="color:#E06C75">E</span><span style="color:#56B6C2">&gt;</span><span style="color:#E5C07B"> List</span><span style="color:#56B6C2">&lt;</span><span style="color:#E06C75">E</span><span style="color:#56B6C2">&gt;</span><span style="color:#61AFEF"> query</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">MappedStatement</span><span style="color:#E06C75"> ms</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> Object</span><span style="color:#E06C75"> parameter</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> RowBounds</span><span style="color:#E06C75"> rowBounds</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> ResultHandler</span><span style="color:#E06C75"> resultHandler</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> CacheKey</span><span style="color:#E06C75"> key</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> BoundSql</span><span style="color:#E06C75"> boundSql) throws SQLException {</span></span>
<span class="line"><span style="color:#E5C07B">    ErrorContext</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">instance</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">resource</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">ms</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getResource</span><span style="color:#ABB2BF">()).</span><span style="color:#61AFEF">activity</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"executing a query"</span><span style="color:#ABB2BF">).</span><span style="color:#61AFEF">object</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">ms</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getId</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#E06C75"> (</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">closed</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#C678DD">        throw</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> ExecutorException</span><span style="color:#E06C75">(</span><span style="color:#98C379">"Executor was closed."</span><span style="color:#E06C75">)</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E06C75">    } </span><span style="color:#C678DD">else</span><span style="color:#E06C75"> {</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#E06C75"> (</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">queryStack</span><span style="color:#56B6C2"> ==</span><span style="color:#D19A66"> 0</span><span style="color:#56B6C2"> &amp;&amp;</span><span style="color:#E5C07B"> ms</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">isFlushCacheRequired</span><span style="color:#ABB2BF">()</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E5C07B">            this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">clearLocalCache</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E06C75">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B">        List</span><span style="color:#E06C75"> list</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">        try</span><span style="color:#E06C75"> {</span></span>
<span class="line"><span style="color:#ABB2BF">            ++</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">queryStack</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">            // 根据key获取缓存中是否存在数据，存在数据从缓存中查询数据，否则从数据库查询数据</span></span>
<span class="line"><span style="color:#E06C75">            list </span><span style="color:#56B6C2">=</span><span style="color:#E06C75"> resultHandler </span><span style="color:#56B6C2">==</span><span style="color:#D19A66"> null</span><span style="color:#C678DD"> ?</span><span style="color:#E06C75"> (List)</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">localCache</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getObject</span><span style="color:#ABB2BF">(key)</span><span style="color:#C678DD"> :</span><span style="color:#D19A66"> null</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">            if</span><span style="color:#E06C75"> (list </span><span style="color:#56B6C2">!=</span><span style="color:#D19A66"> null</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E5C07B">                this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">handleLocallyCachedOutputParameters</span><span style="color:#ABB2BF">(ms, key, parameter, boundSql);</span></span>
<span class="line"><span style="color:#E06C75">            } </span><span style="color:#C678DD">else</span><span style="color:#E06C75"> {</span></span>
<span class="line"><span style="color:#E06C75">                list </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">queryFromDatabase</span><span style="color:#ABB2BF">(ms, parameter, rowBounds, resultHandler, key, boundSql);</span></span>
<span class="line"><span style="color:#E06C75">            }</span></span>
<span class="line"><span style="color:#E06C75">        } </span><span style="color:#C678DD">finally</span><span style="color:#E06C75"> {</span></span>
<span class="line"><span style="color:#ABB2BF">            --</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">queryStack</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E06C75">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#E06C75"> (</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">queryStack</span><span style="color:#56B6C2"> ==</span><span style="color:#D19A66"> 0</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E5C07B">            Iterator</span><span style="color:#E06C75"> var8 </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">deferredLoads</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">iterator</span><span style="color:#ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">            while</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">var8</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">hasNext</span><span style="color:#ABB2BF">()</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E5C07B">                DeferredLoad</span><span style="color:#E06C75"> deferredLoad </span><span style="color:#56B6C2">=</span><span style="color:#E06C75"> (DeferredLoad)</span><span style="color:#E5C07B">var8</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">next</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">                deferredLoad</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">load</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E06C75">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B">            this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">deferredLoads</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">clear</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#C678DD">            if</span><span style="color:#E06C75"> (</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">configuration</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getLocalCacheScope</span><span style="color:#ABB2BF">()</span><span style="color:#56B6C2"> ==</span><span style="color:#E5C07B"> LocalCacheScope</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">STATEMENT</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E5C07B">                this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">clearLocalCache</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E06C75">            }</span></span>
<span class="line"><span style="color:#E06C75">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E06C75"> list</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E06C75">    }</span></span>
<span class="line"><span style="color:#E06C75">}</span></span>
<span class="line"></span></code></pre>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#C678DD">private</span><span style="color:#56B6C2"> &lt;</span><span style="color:#E06C75">E</span><span style="color:#56B6C2">&gt;</span><span style="color:#E5C07B"> List</span><span style="color:#56B6C2">&lt;</span><span style="color:#E06C75">E</span><span style="color:#56B6C2">&gt;</span><span style="color:#61AFEF"> queryFromDatabase</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">MappedStatement</span><span style="color:#E06C75"> ms</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> Object</span><span style="color:#E06C75"> parameter</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> RowBounds</span><span style="color:#E06C75"> rowBounds</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> ResultHandler</span><span style="color:#E06C75"> resultHandler</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> CacheKey</span><span style="color:#E06C75"> key</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> BoundSql</span><span style="color:#E06C75"> boundSql) throws SQLException {</span></span>
<span class="line"><span style="color:#E5C07B">    this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">localCache</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">putObject</span><span style="color:#ABB2BF">(key, </span><span style="color:#E5C07B">ExecutionPlaceholder</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">EXECUTION_PLACEHOLDER</span><span style="color:#ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B">    List</span><span style="color:#E06C75"> list</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">    try</span><span style="color:#E06C75"> {</span></span>
<span class="line"><span style="color:#E06C75">        list </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">doQuery</span><span style="color:#ABB2BF">(ms, parameter, rowBounds, resultHandler, boundSql);</span></span>
<span class="line"><span style="color:#E06C75">    } </span><span style="color:#C678DD">finally</span><span style="color:#E06C75"> {</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">localCache</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">removeObject</span><span style="color:#ABB2BF">(key);</span></span>
<span class="line"><span style="color:#E06C75">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B">    this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">localCache</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">putObject</span><span style="color:#ABB2BF">(key, list);</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#E06C75"> (</span><span style="color:#E5C07B">ms</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getStatementType</span><span style="color:#ABB2BF">()</span><span style="color:#56B6C2"> ==</span><span style="color:#E5C07B"> StatementType</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">CALLABLE</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">localOutputParameterCache</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">putObject</span><span style="color:#ABB2BF">(key, parameter);</span></span>
<span class="line"><span style="color:#E06C75">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#E06C75"> list</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E06C75">}</span></span>
<span class="line"></span></code></pre>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#C678DD">public</span><span style="color:#61AFEF"> RoutingStatementHandler</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">Executor</span><span style="color:#E06C75"> executor</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> MappedStatement</span><span style="color:#E06C75"> ms</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> Object</span><span style="color:#E06C75"> parameter</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> RowBounds</span><span style="color:#E06C75"> rowBounds</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> ResultHandler</span><span style="color:#E06C75"> resultHandler</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> BoundSql</span><span style="color:#E06C75"> boundSql) {</span></span>
<span class="line"><span style="color:#C678DD">    switch</span><span style="color:#E06C75"> (</span><span style="color:#E5C07B">ms</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getStatementType</span><span style="color:#ABB2BF">()</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">            // 普通类型</span></span>
<span class="line"><span style="color:#C678DD">        case</span><span style="color:#E06C75"> STATEMENT</span><span style="color:#C678DD">:</span></span>
<span class="line"><span style="color:#E5C07B">            this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">delegate</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> SimpleStatementHandler</span><span style="color:#E06C75">(executor</span><span style="color:#ABB2BF">,</span><span style="color:#E06C75"> ms</span><span style="color:#ABB2BF">,</span><span style="color:#E06C75"> parameter</span><span style="color:#ABB2BF">,</span><span style="color:#E06C75"> rowBounds</span><span style="color:#ABB2BF">,</span><span style="color:#E06C75"> resultHandler</span><span style="color:#ABB2BF">,</span><span style="color:#E06C75"> boundSql)</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">            break</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">            // 预编译</span></span>
<span class="line"><span style="color:#C678DD">        case</span><span style="color:#E06C75"> PREPARED</span><span style="color:#C678DD">:</span></span>
<span class="line"><span style="color:#E5C07B">            this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">delegate</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> PreparedStatementHandler</span><span style="color:#E06C75">(executor</span><span style="color:#ABB2BF">,</span><span style="color:#E06C75"> ms</span><span style="color:#ABB2BF">,</span><span style="color:#E06C75"> parameter</span><span style="color:#ABB2BF">,</span><span style="color:#E06C75"> rowBounds</span><span style="color:#ABB2BF">,</span><span style="color:#E06C75"> resultHandler</span><span style="color:#ABB2BF">,</span><span style="color:#E06C75"> boundSql)</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">            break</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">            // 存储过程</span></span>
<span class="line"><span style="color:#C678DD">        case</span><span style="color:#E06C75"> CALLABLE</span><span style="color:#C678DD">:</span></span>
<span class="line"><span style="color:#E5C07B">            this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">delegate</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> CallableStatementHandler</span><span style="color:#E06C75">(executor</span><span style="color:#ABB2BF">,</span><span style="color:#E06C75"> ms</span><span style="color:#ABB2BF">,</span><span style="color:#E06C75"> parameter</span><span style="color:#ABB2BF">,</span><span style="color:#E06C75"> rowBounds</span><span style="color:#ABB2BF">,</span><span style="color:#E06C75"> resultHandler</span><span style="color:#ABB2BF">,</span><span style="color:#E06C75"> boundSql)</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">            break</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">        default:</span></span>
<span class="line"><span style="color:#C678DD">            throw</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> ExecutorException</span><span style="color:#E06C75">(</span><span style="color:#98C379">"Unknown statement type: "</span><span style="color:#56B6C2"> +</span><span style="color:#E5C07B"> ms</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getStatementType</span><span style="color:#ABB2BF">()</span><span style="color:#E06C75">)</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E06C75">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75">}</span></span>
<span class="line"></span></code></pre>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#C678DD">public</span><span style="color:#61AFEF"> ResultSetWrapper</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">ResultSet</span><span style="color:#E06C75"> rs</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> Configuration</span><span style="color:#E06C75"> configuration) throws SQLException {</span></span>
<span class="line"><span style="color:#E5C07B">    this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">typeHandlerRegistry</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> configuration</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getTypeHandlerRegistry</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">    this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">resultSet</span><span style="color:#56B6C2"> =</span><span style="color:#E06C75"> rs</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E5C07B">    ResultSetMetaData</span><span style="color:#E06C75"> metaData </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> rs</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getMetaData</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // 获取表行数</span></span>
<span class="line"><span style="color:#C678DD">    int</span><span style="color:#E06C75"> columnCount </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> metaData</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getColumnCount</span><span style="color:#ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    for</span><span style="color:#E06C75">(</span><span style="color:#C678DD">int</span><span style="color:#E06C75"> i </span><span style="color:#56B6C2">=</span><span style="color:#D19A66"> 1</span><span style="color:#ABB2BF">;</span><span style="color:#E06C75"> i </span><span style="color:#56B6C2">&lt;=</span><span style="color:#E06C75"> columnCount</span><span style="color:#ABB2BF">;</span><span style="color:#ABB2BF"> ++</span><span style="color:#E06C75">i) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // columnNames 字段名称</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">columnNames</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">add</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">configuration</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">isUseColumnLabel</span><span style="color:#ABB2BF">() </span><span style="color:#C678DD">?</span><span style="color:#E5C07B"> metaData</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getColumnLabel</span><span style="color:#ABB2BF">(i) </span><span style="color:#C678DD">:</span><span style="color:#E5C07B"> metaData</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getColumnName</span><span style="color:#ABB2BF">(i));</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // jdbcTypes 数据库字段类型</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">jdbcTypes</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">add</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">JdbcType</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">forCode</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">metaData</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getColumnType</span><span style="color:#ABB2BF">(i)));</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // classNames java 字段类型</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">classNames</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">add</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">metaData</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getColumnClassName</span><span style="color:#ABB2BF">(i));</span></span>
<span class="line"><span style="color:#E06C75">    }</span></span>
<span class="line"><span style="color:#E06C75">}</span></span>
<span class="line"></span></code></pre>
<h3 id="spring整合mybatis-实现">spring整合mybatis 实现</h3>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Autowired</span></span>
<span class="line"><span style="color:#C678DD">private</span><span style="color:#E5C07B"> UserMapper</span><span style="color:#E06C75"> userMapper</span><span style="color:#ABB2BF">;</span><span style="color:#7F848E;font-style:italic"> // Mybatis生成的UserMapper代理对象 --&gt; Bean对象</span></span>
<span class="line"></span></code></pre>
<h2 id="sqlsessionfactorybean的底层原理">SqlSessionFactoryBean的底层原理</h2>
<p>SqlSessionFactoryBean是MyBatis框架中的一个重要组件，它的主要作用是创建SqlSessionFactory对象，SqlSessionFactory是MyBatis框架中的核心对象，它负责管理MyBatis的所有配置信息，并且提供了创建SqlSession对象的方法。SqlSessionFactoryBean的底层原理是通过读取MyBatis的配置文件，解析其中的配置信息，然后根据配置信息创建SqlSessionFactory对象。在创建SqlSessionFactory对象的过程中，SqlSessionFactoryBean会使用MyBatis框架中的多个组件，包括Configuration、MapperRegistry、TypeHandlerRegistry等，这些组件都是MyBatis框架中的核心组件，它们负责管理MyBatis的各种配置信息，并且提供了各种功能的实现。SqlSessionFactoryBean的底层原理比较复杂，需要深入了解MyBatis框架的各个组件之间的关系和作用，才能更好地理解它的实现原理。</p>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Bean</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#E5C07B"> SqlSessionFactory</span><span style="color:#61AFEF"> sqlSessionFactory</span><span style="color:#E06C75">() throws IOException{</span></span>
<span class="line"><span style="color:#E5C07B">    InputStream</span><span style="color:#E06C75"> inputStream </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> Resources</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getResourceAsStream</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"mybatis-config.xml"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> SqlSessionFactoryBuilder</span><span style="color:#E06C75">()</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">build</span><span style="color:#ABB2BF">(inputStream);</span></span>
<span class="line"><span style="color:#E06C75">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Bean</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#E5C07B"> UserMapper</span><span style="color:#61AFEF"> userMapper</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">SqlSessionFactory</span><span style="color:#E06C75"> sqlSessionFactory) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // Mybatis 代理对象</span></span>
<span class="line"><span style="color:#E5C07B">    sqlSessionFactory</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getConfiguration</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">addMapper</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">UserMapper</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E5C07B">    SqlSession</span><span style="color:#E06C75"> sqlSession </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> sqlSessionFactory</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">openSession</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#E5C07B"> sqlSession</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getMapper</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">UserMapper</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E06C75">}</span></span>
<span class="line"></span></code></pre>
<h2 id="factorybean的作用和底层工作原理">FactoryBean的作用和底层工作原理</h2>
<p>FactoryBean是Spring框架中的一个接口，它的作用是用于创建和管理Bean对象。FactoryBean可以将复杂的Bean对象的创建过程封装起来，使得应用程序只需要通过FactoryBean获取Bean对象即可，而不需要关心Bean对象的创建过程。FactoryBean的底层工作原理是通过实现getObject()方法来创建Bean对象，同时还可以通过实现其他方法来控制Bean对象的生命周期和行为。</p>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Component</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> TestFactoryBean</span><span style="color:#C678DD"> implements</span><span style="color:#E5C07B"> FactoryBean</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // 实现FactoryBean接口会生成两个Bean对象 1、TestFactoryBean 2、getObject</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // 先生成TestFactoryBean 之后再生成 getObject</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Autowired</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> SqlSessionFactory</span><span style="color:#E06C75"> sqlSessionFactory</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Override</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> Object</span><span style="color:#61AFEF"> getObject</span><span style="color:#ABB2BF">()</span><span style="color:#C678DD"> throws</span><span style="color:#E5C07B"> Exception</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        sqlSessionFactory</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getConfiguration</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">addMapper</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">UserMapper</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E5C07B">        SqlSession</span><span style="color:#E06C75"> sqlSession</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> sqlSessionFactory</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">openSession</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> sqlSession</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getMapper</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">UserMapper</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Override</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> Class</span><span style="color:#ABB2BF">&lt;</span><span style="color:#C678DD">?</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> getObjectType</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> UserMapper</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<p>FactoryBean复用</p>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#E5C07B">AnnotationConfigApplicationContext</span><span style="color:#E06C75"> applicationContext </span><span style="color:#56B6C2">=</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> AnnotationConfigApplicationContext</span><span style="color:#E06C75">()</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E5C07B">applicationContext</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">register</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">DegreeApplication</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">// 与@Component 一样的作用</span></span>
<span class="line"><span style="color:#E5C07B">AbstractBeanDefinition</span><span style="color:#E06C75"> beanDefinition </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> BeanDefinitionBuilder</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">genericBeanDefinition</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">getBeanDefinition</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">beanDefinition</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setBeanClass</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">TestFactoryBean</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E5C07B">beanDefinition</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getConstructorArgumentValues</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">addGenericArgumentValue</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">UserMapper</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E5C07B">applicationContext</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">registerBeanDefinition</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"userMapper"</span><span style="color:#ABB2BF">, beanDefinition);</span></span>
<span class="line"></span></code></pre>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Component</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> TestFactoryBean</span><span style="color:#C678DD"> implements</span><span style="color:#E5C07B"> FactoryBean</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">  @</span><span style="color:#E5C07B">Autowired</span></span>
<span class="line"><span style="color:#C678DD">  private</span><span style="color:#E5C07B"> SqlSessionFactory</span><span style="color:#E06C75"> sqlSessionFactory</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">  private</span><span style="color:#C678DD"> final</span><span style="color:#E5C07B"> Class</span><span style="color:#E06C75"> mapperClass</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">  public</span><span style="color:#61AFEF"> TestFactoryBean</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Class</span><span style="color:#E06C75;font-style:italic"> mapperClass</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">    this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">mapperClass</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> mapperClass;</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">  @</span><span style="color:#E5C07B">Override</span></span>
<span class="line"><span style="color:#C678DD">  public</span><span style="color:#E5C07B"> Object</span><span style="color:#61AFEF"> getObject</span><span style="color:#ABB2BF">()</span><span style="color:#C678DD"> throws</span><span style="color:#E5C07B"> Exception</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">    sqlSessionFactory</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getConfiguration</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">addMapper</span><span style="color:#ABB2BF">(mapperClass);</span></span>
<span class="line"><span style="color:#E5C07B">    SqlSession</span><span style="color:#E06C75"> sqlSession</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> sqlSessionFactory</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">openSession</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#E5C07B"> sqlSession</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getMapper</span><span style="color:#ABB2BF">(mapperClass);</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">  @</span><span style="color:#E5C07B">Override</span></span>
<span class="line"><span style="color:#C678DD">  public</span><span style="color:#E5C07B"> Class</span><span style="color:#ABB2BF">&lt;</span><span style="color:#C678DD">?</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> getObjectType</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#E5C07B"> User</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<h2 id="importbeandefinitionregistrar底层原理">ImportBeanDefinitionRegistrar底层原理</h2>
<ol>
<li>ImportBeanDefinitionRegistrar实现类重写registerBeanDefinitions方法。</li>
<li>在registerBeanDefinitions方法中，通过BeanDefinitionRegistry接口注册bean定义。</li>
</ol>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> TestImportBeanDefinitionRegistrar</span><span style="color:#C678DD"> implements</span><span style="color:#E5C07B"> ImportBeanDefinitionRegistrar</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Override</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> void</span><span style="color:#61AFEF"> registerBeanDefinitions</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">AnnotationMetadata</span><span style="color:#E06C75;font-style:italic"> importingClassMetadata</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">BeanDefinitionRegistry</span><span style="color:#E06C75;font-style:italic"> registry</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        ArrayList</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">Class</span><span style="color:#ABB2BF">&gt; </span><span style="color:#E06C75">list</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> new</span><span style="color:#E5C07B"> ArrayList</span><span style="color:#ABB2BF">&lt;&gt;();</span></span>
<span class="line"><span style="color:#E5C07B">        list</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">add</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">UserMapper</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">        for</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">Class</span><span style="color:#E06C75"> mapperClass</span><span style="color:#C678DD"> :</span><span style="color:#ABB2BF"> list) {</span></span>
<span class="line"><span style="color:#E5C07B">            AbstractBeanDefinition</span><span style="color:#E06C75"> beanDefinition</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> BeanDefinitionBuilder</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">genericBeanDefinition</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">getBeanDefinition</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">            beanDefinition</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setBeanClass</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">TestFactoryBean</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E5C07B">            beanDefinition</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getConstructorArgumentValues</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">addGenericArgumentValue</span><span style="color:#ABB2BF">(mapperClass);</span></span>
<span class="line"><span style="color:#E5C07B">            registry</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">registerBeanDefinition</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">mapperClass</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getName</span><span style="color:#ABB2BF">(), beanDefinition);</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#7F848E;font-style:italic">// 使用@Import 导入配置的类</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Import</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">TestImportBeanDefinitionRegistrar</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> DegreeApplication</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<h2 id="mapperscannerconfigurer底层源码分析">MapperScannerConfigurer底层源码分析</h2>
<ul>
<li>MapperScannerConfigurer底层源码分析。</li>
<li>MapperScannerConfigurer是MyBatis提供的一个BeanFactoryPostProcessor，用于扫描指定包下的Mapper接口，并将其注册到Spring容器中。</li>
<li>在MyBatis中，Mapper接口是通过MapperProxyFactory来创建代理对象的，而MapperScannerConfigurer的作用就是将Mapper接口的代理对象注册到Spring容器中，以便在需要使用Mapper接口时，可以直接从Spring容器中获取代理对象。</li>
<li>MapperScannerConfigurer的实现原理是通过Spring的ClassPathBeanDefinitionScanner来扫描指定包下的所有类，然后判断是否是Mapper接口，如果是，则将其注册到Spring容器中。</li>
<li>在注册Mapper接口时，MapperScannerConfigurer会为每个Mapper接口创建一个MapperFactoryBean，MapperFactoryBean是一个FactoryBean，用于创建Mapper接口的代理对象。</li>
<li>MapperFactoryBean的实现原理是通过MapperProxyFactory来创建Mapper接口的代理对象，然后将其返回给Spring容器。</li>
<li>总结一下，MapperScannerConfigurer的作用是将Mapper接口的代理对象注册到Spring容器中，以便在需要使用Mapper接口时，可以直接从Spring容器中获取代理对象。MapperScannerConfigurer的实现原理是通过Spring的ClassPathBeanDefinitionScanner来扫描指定包下的所有类，然后判断是否是Mapper接口，如果是，则将其注册到Spring容器中，并为每个Mapper接口创建一个MapperFactoryBean，用于创建Mapper接口的代理对象。</li>
</ul>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> TestMapperScanner</span><span style="color:#C678DD"> extends</span><span style="color:#E5C07B"> ClassPathBeanDefinitionScanner</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Override</span></span>
<span class="line"><span style="color:#C678DD">    protected</span><span style="color:#C678DD"> boolean</span><span style="color:#61AFEF"> isCandidateComponent</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">MetadataReader</span><span style="color:#E06C75;font-style:italic"> metadataReader</span><span style="color:#ABB2BF">)</span><span style="color:#C678DD"> throws</span><span style="color:#E5C07B"> IOException</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // 是否 @component 注解</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#D19A66"> true</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Override</span></span>
<span class="line"><span style="color:#C678DD">    protected</span><span style="color:#C678DD"> boolean</span><span style="color:#61AFEF"> isCandidateComponent</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">AnnotatedBeanDefinition</span><span style="color:#E06C75;font-style:italic"> beanDefinition</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // 是否 接口类</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> beanDefinition</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getMetadata</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">isInterface</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#61AFEF"> TestMapperScanner</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">BeanDefinitionRegistry</span><span style="color:#E06C75;font-style:italic"> registry</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        super</span><span style="color:#ABB2BF">(registry);</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Override</span></span>
<span class="line"><span style="color:#C678DD">    protected</span><span style="color:#E5C07B"> Set</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">BeanDefinitionHolder</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> doScan</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">String</span><span style="color:#ABB2BF">... </span><span style="color:#E06C75;font-style:italic">basePackages</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // 重写 doScan 方法</span></span>
<span class="line"><span style="color:#E5C07B">        Set</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">BeanDefinitionHolder</span><span style="color:#ABB2BF">&gt; </span><span style="color:#E06C75">beanDefinitionHolders</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> super</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">doScan</span><span style="color:#ABB2BF">(basePackages);</span></span>
<span class="line"><span style="color:#C678DD">        for</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">BeanDefinitionHolder</span><span style="color:#E06C75"> beanDefinitionHolder</span><span style="color:#C678DD"> :</span><span style="color:#ABB2BF"> beanDefinitionHolders) {</span></span>
<span class="line"><span style="color:#E5C07B">            GenericBeanDefinition</span><span style="color:#E06C75"> genericBeanDefinition</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> (GenericBeanDefinition) </span><span style="color:#E5C07B">beanDefinitionHolder</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getBeanDefinition</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">            genericBeanDefinition</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getConstructorArgumentValues</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">addGenericArgumentValue</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Objects</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">requireNonNull</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">genericBeanDefinition</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getBeanClassName</span><span style="color:#ABB2BF">()));</span></span>
<span class="line"><span style="color:#E5C07B">            genericBeanDefinition</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setBeanClass</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">TestFactoryBean</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#ABB2BF"> beanDefinitionHolders;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<p>使用MapperScanner自定义扫描mapper。</p>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> TestImportBeanDefinitionRegistrar</span><span style="color:#C678DD"> implements</span><span style="color:#E5C07B"> ImportBeanDefinitionRegistrar</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Override</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> void</span><span style="color:#61AFEF"> registerBeanDefinitions</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">AnnotationMetadata</span><span style="color:#E06C75;font-style:italic"> importingClassMetadata</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">BeanDefinitionRegistry</span><span style="color:#E06C75;font-style:italic"> registry</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        TestMapperScanner</span><span style="color:#E06C75"> testMapperScanner</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> TestMapperScanner</span><span style="color:#ABB2BF">(registry);</span></span>
<span class="line"><span style="color:#E5C07B">        testMapperScanner</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">scan</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"com.second.degree.java.mybatis.mapper"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<h2 id="mapperscan注解的底层源码分析">@MapperScan注解的底层源码分析</h2>
<p>@MapperScan注解是MyBatis框架提供的一个注解，用于扫描Mapper接口并将其注册到Spring容器中。其底层源码分析可以从以下几个方面入手：</p>
<ol>
<li>@MapperScan注解的定义：可以查看该注解的定义，了解其属性和作用。</li>
<li>扫描器的实现：@MapperScan注解的底层实现是通过扫描器实现的，可以查看扫描器的源码，了解其扫描的规则和实现方式。</li>
<li>注册Mapper接口：扫描器扫描到Mapper接口后，需要将其注册到Spring容器中，可以查看注册的源码，了解其实现方式和注册的规则。</li>
<li>与Spring集成：@MapperScan注解是与Spring集成的，可以查看其与Spring集成的源码，了解其实现方式和与Spring的交互方式。</li>
</ol>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Target</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">ElementType</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">TYPE</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Retention</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">RetentionPolicy</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">RUNTIME</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Import</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">TestImportBeanDefinitionRegistrar</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#ABB2BF"> @</span><span style="color:#C678DD">interface</span><span style="color:#E5C07B"> TestMapperScan</span><span style="color:#E06C75"> {</span></span>
<span class="line"><span style="color:#E5C07B">    String</span><span style="color:#61AFEF"> value</span><span style="color:#E06C75">()</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E06C75">}</span></span>
<span class="line"></span></code></pre>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">TestMapperScan</span><span style="color:#E06C75">(</span><span style="color:#98C379">"com.second.degree.java.mybatis.mapper"</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> DegreeApplication</span><span style="color:#ABB2BF"> {}</span></span>
<span class="line"></span></code></pre>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> TestImportBeanDefinitionRegistrar</span><span style="color:#C678DD"> implements</span><span style="color:#E5C07B"> ImportBeanDefinitionRegistrar</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Override</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> void</span><span style="color:#61AFEF"> registerBeanDefinitions</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">AnnotationMetadata</span><span style="color:#E06C75;font-style:italic"> importingClassMetadata</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">BeanDefinitionRegistry</span><span style="color:#E06C75;font-style:italic"> registry</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B">        Map</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">String</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">Object</span><span style="color:#ABB2BF">&gt; </span><span style="color:#E06C75">annotationAttributes</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> importingClassMetadata</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getAnnotationAttributes</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">TestMapperScan</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getName</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#E5C07B">        String</span><span style="color:#E06C75"> path</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> (String) </span><span style="color:#E5C07B">annotationAttributes</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">get</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"value"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B">        TestMapperScanner</span><span style="color:#E06C75"> testMapperScanner</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> TestMapperScanner</span><span style="color:#ABB2BF">(registry);</span></span>
<span class="line"><span style="color:#E5C07B">        testMapperScanner</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">scan</span><span style="color:#ABB2BF">(path);</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<h2 id="spring整合mybatis的底层源码分析">Spring整合Mybatis的底层源码分析</h2>
<p>mybaits 2.0.6 以下版本直接在registerBeanDefinitions 中实现 Scanner 扫描器，使用注解@MapperScan。</p>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">MapperScan</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> DegreeApplication</span><span style="color:#ABB2BF"> {}</span></span>
<span class="line"></span></code></pre>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#C678DD">void</span><span style="color:#61AFEF"> registerBeanDefinitions</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">AnnotationAttributes</span><span style="color:#E06C75"> annoAttrs</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> BeanDefinitionRegistry</span><span style="color:#E06C75"> registry) {</span></span>
<span class="line"><span style="color:#E5C07B">        ClassPathMapperScanner</span><span style="color:#E06C75"> scanner </span><span style="color:#56B6C2">=</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> ClassPathMapperScanner</span><span style="color:#E06C75">(registry)</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">    ...</span></span>
<span class="line"><span style="color:#E06C75">}</span></span>
<span class="line"></span></code></pre>
<p>mybaits 2.0.6 以上版本 是通过另一个Bean MapperScannerConfigurer 实现Scanner 扫描器，可以不使用@MapperScan，通过注册MapperScannerConfigurer 实现扫描。</p>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#C678DD">void</span><span style="color:#61AFEF"> registerBeanDefinitions</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">AnnotationMetadata</span><span style="color:#E06C75"> annoMeta</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> AnnotationAttributes</span><span style="color:#E06C75"> annoAttrs</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> BeanDefinitionRegistry</span><span style="color:#E06C75"> registry</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> beanName) {</span></span>
<span class="line"><span style="color:#E5C07B">        BeanDefinitionBuilder</span><span style="color:#E06C75"> builder </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> BeanDefinitionBuilder</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">genericBeanDefinition</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">MapperScannerConfigurer</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">    ...</span></span>
<span class="line"><span style="color:#E06C75">}</span></span>
<span class="line"></span></code></pre>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> DegreeApplication</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Bean</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> MapperScannerConfigurer</span><span style="color:#61AFEF"> mapperScannerConfigurer</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        MapperScannerConfigurer</span><span style="color:#E06C75"> configurer</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> MapperScannerConfigurer</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">        configurer</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setBasePackage</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"com.second.degree.java.mybatis.mapper"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#ABB2BF"> configurer;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<h2 id="springboot整合mybatis的底层源码分析">SpringBoot整合Mybatis的底层源码分析</h2>
<ol>
<li>
<p>使用@MapperScan，会扫到很多无用的类，效率会差点。mybatis-spring包。</p>
</li>
<li>
<p>自动配置类MybatisAutoConfiguration。mybatis-spring-boot-autoconfigure包。</p>
<pre class="astro-code one-dark-pro" style="color:#abb2bf;white-space:pre-wrap;word-wrap:break-word;background-color:#282c34;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> void</span><span style="color:#61AFEF"> registerBeanDefinitions</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">AnnotationMetadata</span><span style="color:#E06C75"> importingClassMetadata</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> BeanDefinitionRegistry</span><span style="color:#E06C75"> registry) {</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#E06C75"> (</span><span style="color:#56B6C2">!</span><span style="color:#E5C07B">AutoConfigurationPackages</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">has</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">beanFactory</span><span style="color:#ABB2BF">)</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E5C07B">        MybatisAutoConfiguration</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">logger</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">debug</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"Could not determine auto-configuration package, automatic mapper scanning disabled."</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E06C75">    } </span><span style="color:#C678DD">else</span><span style="color:#E06C75"> {</span></span>
<span class="line"><span style="color:#E5C07B">        MybatisAutoConfiguration</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">logger</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">debug</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"Searching for mappers annotated with @Mapper"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // 扫描的包路径 为 springboot 启动 run 方法的路径</span></span>
<span class="line"><span style="color:#E5C07B">        List</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">String</span><span style="color:#ABB2BF">&gt;</span><span style="color:#E06C75"> packages </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> AutoConfigurationPackages</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">get</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">beanFactory</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#E06C75"> (</span><span style="color:#E5C07B">MybatisAutoConfiguration</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">logger</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">isDebugEnabled</span><span style="color:#ABB2BF">()</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E5C07B">            packages</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">forEach</span><span style="color:#ABB2BF">((pkg) </span><span style="color:#C678DD">-&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">                MybatisAutoConfiguration</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">logger</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">debug</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"Using auto-configuration base package '{}'"</span><span style="color:#ABB2BF">, pkg);</span></span>
<span class="line"><span style="color:#ABB2BF">            });</span></span>
<span class="line"><span style="color:#E06C75">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B">        BeanDefinitionBuilder</span><span style="color:#E06C75"> builder </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> BeanDefinitionBuilder</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">genericBeanDefinition</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">MapperScannerConfigurer</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E5C07B">        builder</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">addPropertyValue</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"processPropertyPlaceHolders"</span><span style="color:#ABB2BF">, </span><span style="color:#D19A66">true</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // 只识别@Mapper 注解定义的接口类</span></span>
<span class="line"><span style="color:#E5C07B">        builder</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">addPropertyValue</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"annotationClass"</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">Mapper</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E5C07B">        builder</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">addPropertyValue</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"basePackage"</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">StringUtils</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">collectionToCommaDelimitedString</span><span style="color:#ABB2BF">(packages));</span></span>
<span class="line"><span style="color:#E5C07B">        BeanWrapper</span><span style="color:#E06C75"> beanWrapper </span><span style="color:#56B6C2">=</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> BeanWrapperImpl</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">MapperScannerConfigurer</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#E06C75">)</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E5C07B">        Set</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">String</span><span style="color:#ABB2BF">&gt;</span><span style="color:#E06C75"> propertyNames </span><span style="color:#56B6C2">=</span><span style="color:#E06C75"> (Set)</span><span style="color:#E5C07B">Stream</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">of</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">beanWrapper</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getPropertyDescriptors</span><span style="color:#ABB2BF">()).</span><span style="color:#61AFEF">map</span><span style="color:#ABB2BF">(FeatureDescriptor</span><span style="color:#C678DD">::</span><span style="color:#ABB2BF">getName).</span><span style="color:#61AFEF">collect</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Collectors</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">toSet</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#E06C75"> (</span><span style="color:#E5C07B">propertyNames</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">contains</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"lazyInitialization"</span><span style="color:#ABB2BF">)</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E5C07B">            builder</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">addPropertyValue</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"lazyInitialization"</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"${mybatis.lazy-initialization:false}"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E06C75">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#E06C75"> (</span><span style="color:#E5C07B">propertyNames</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">contains</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"defaultScope"</span><span style="color:#ABB2BF">)</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E5C07B">            builder</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">addPropertyValue</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"defaultScope"</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"${mybatis.mapper-default-scope:}"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E06C75">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">        boolean</span><span style="color:#E06C75"> injectSqlSession </span><span style="color:#56B6C2">=</span><span style="color:#E06C75"> (Boolean)</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">environment</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getProperty</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"mybatis.inject-sql-session-on-mapper-scan"</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">Boolean</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">Boolean</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">TRUE</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#E06C75"> (injectSqlSession </span><span style="color:#56B6C2">&amp;&amp;</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">beanFactory</span><span style="color:#C678DD"> instanceof</span><span style="color:#E06C75"> ListableBeanFactory) {</span></span>
<span class="line"><span style="color:#E5C07B">            ListableBeanFactory</span><span style="color:#E06C75"> listableBeanFactory </span><span style="color:#56B6C2">=</span><span style="color:#E06C75"> (ListableBeanFactory)</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">beanFactory</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E5C07B">            Optional</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">String</span><span style="color:#ABB2BF">&gt;</span><span style="color:#E06C75"> sqlSessionTemplateBeanName </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> Optional</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">ofNullable</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getBeanNameForType</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">SqlSessionTemplate</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">, listableBeanFactory));</span></span>
<span class="line"><span style="color:#E5C07B">            Optional</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">String</span><span style="color:#ABB2BF">&gt;</span><span style="color:#E06C75"> sqlSessionFactoryBeanName </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> Optional</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">ofNullable</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getBeanNameForType</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">SqlSessionFactory</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">, listableBeanFactory));</span></span>
<span class="line"><span style="color:#C678DD">            if</span><span style="color:#E06C75"> (</span><span style="color:#56B6C2">!</span><span style="color:#E5C07B">sqlSessionTemplateBeanName</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">isPresent</span><span style="color:#ABB2BF">()</span><span style="color:#56B6C2"> &amp;&amp;</span><span style="color:#E5C07B"> sqlSessionFactoryBeanName</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">isPresent</span><span style="color:#ABB2BF">()</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E5C07B">                builder</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">addPropertyValue</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"sqlSessionFactoryBeanName"</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">sqlSessionFactoryBeanName</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">get</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#E06C75">            } </span><span style="color:#C678DD">else</span><span style="color:#E06C75"> {</span></span>
<span class="line"><span style="color:#E5C07B">                builder</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">addPropertyValue</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"sqlSessionTemplateBeanName"</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">sqlSessionTemplateBeanName</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">orElse</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"sqlSessionTemplate"</span><span style="color:#ABB2BF">));</span></span>
<span class="line"><span style="color:#E06C75">            }</span></span>
<span class="line"><span style="color:#E06C75">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B">        builder</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setRole</span><span style="color:#ABB2BF">(</span><span style="color:#D19A66">2</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E5C07B">        registry</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">registerBeanDefinition</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">MapperScannerConfigurer</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getName</span><span style="color:#ABB2BF">(), </span><span style="color:#E5C07B">builder</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getBeanDefinition</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#E06C75">    }</span></span>
<span class="line"><span style="color:#E06C75">}</span></span>
<span class="line"></span></code></pre>
</li>
</ol> </article> <ul class="astro-vj4tpspi my-8"> <li class="inline-block astro-blwjyjpt my-1 underline-offset-4"> <a href="/astro/tags/java/" class="astro-blwjyjpt group pr-2 text-sm" data-astro-transition-scope="astro-36ssibgs-2"> <svg xmlns="http://www.w3.org/2000/svg" class="astro-blwjyjpt scale-75"><path d="M16.018 3.815 15.232 8h-4.966l.716-3.815-1.964-.37L8.232 8H4v2h3.857l-.751 4H3v2h3.731l-.714 3.805 1.965.369L8.766 16h4.966l-.714 3.805 1.965.369.783-4.174H20v-2h-3.859l.751-4H21V8h-3.733l.716-3.815-1.965-.37zM14.106 14H9.141l.751-4h4.966l-.752 4z" class="astro-blwjyjpt"></path> </svg>
&nbsp;<span class="astro-blwjyjpt">java</span> </a> </li> <li class="inline-block astro-blwjyjpt my-1 underline-offset-4"> <a href="/astro/tags/mybatis/" class="astro-blwjyjpt group pr-2 text-sm" data-astro-transition-scope="astro-36ssibgs-3"> <svg xmlns="http://www.w3.org/2000/svg" class="astro-blwjyjpt scale-75"><path d="M16.018 3.815 15.232 8h-4.966l.716-3.815-1.964-.37L8.232 8H4v2h3.857l-.751 4H3v2h3.731l-.714 3.805 1.965.369L8.766 16h4.966l-.714 3.805 1.965.369.783-4.174H20v-2h-3.859l.751-4H21V8h-3.733l.716-3.815-1.965-.37zM14.106 14H9.141l.751-4h4.966l-.752 4z" class="astro-blwjyjpt"></path> </svg>
&nbsp;<span class="astro-blwjyjpt">mybatis</span> </a> </li>  </ul> <div class="astro-vj4tpspi flex items-center flex-col-reverse gap-6 justify-between sm:flex-row-reverse sm:gap-4 sm:items-end"> <button id="back-to-top" class="astro-vj4tpspi focus-outline hover:opacity-75 py-1 whitespace-nowrap"> <svg xmlns="http://www.w3.org/2000/svg" class="astro-vj4tpspi rotate-90"> <path d="M13.293 6.293 7.586 12l5.707 5.707 1.414-1.414L10.414 12l4.293-4.293z" class="astro-vj4tpspi"></path> </svg> <span class="astro-vj4tpspi">Back to Top</span> </button> <div class="astro-wkojbtzc social-icons"> <span class="astro-wkojbtzc italic">Share this post on:</span> <div class="astro-wkojbtzc text-center"> <a href="https://wa.me/?text=https://chou401.github.io/astro/posts/mybatis-integrated-underlying-source-code/" class="astro-wkojbtzc group hover:text-skin-accent inline-block link-button" title="Share this post via WhatsApp"> <svg xmlns="http://www.w3.org/2000/svg" class="icon-tabler" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M3 21l1.65 -3.8a9 9 0 1 1 3.4 2.9l-5.05 .9"></path>
      <path d="M9 10a0.5 .5 0 0 0 1 0v-1a0.5 .5 0 0 0 -1 0v1a5 5 0 0 0 5 5h1a0.5 .5 0 0 0 0 -1h-1a0.5 .5 0 0 0 0 1"></path>
    </svg> <span class="astro-wkojbtzc sr-only">Share this post via WhatsApp</span> </a><a href="https://www.facebook.com/sharer.php?u=https://chou401.github.io/astro/posts/mybatis-integrated-underlying-source-code/" class="astro-wkojbtzc group hover:text-skin-accent inline-block link-button" title="Share this post on Facebook"> <svg xmlns="http://www.w3.org/2000/svg" class="icon-tabler" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
    <path d="M7 10v4h3v7h4v-7h3l1 -4h-4v-2a1 1 0 0 1 1 -1h3v-4h-3a5 5 0 0 0 -5 5v2h-3"></path>
  </svg> <span class="astro-wkojbtzc sr-only">Share this post on Facebook</span> </a><a href="https://twitter.com/intent/tweet?url=https://chou401.github.io/astro/posts/mybatis-integrated-underlying-source-code/" class="astro-wkojbtzc group hover:text-skin-accent inline-block link-button" title="Tweet this post"> <svg xmlns="http://www.w3.org/2000/svg" class="icon-tabler" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z"></path>
    </svg> <span class="astro-wkojbtzc sr-only">Tweet this post</span> </a><a href="https://t.me/share/url?url=https://chou401.github.io/astro/posts/mybatis-integrated-underlying-source-code/" class="astro-wkojbtzc group hover:text-skin-accent inline-block link-button" title="Share this post via Telegram"> <svg xmlns="http://www.w3.org/2000/svg" class="icon-tabler" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M15 10l-4 4l6 6l4 -16l-18 7l4 2l2 6l3 -4"></path>
      </svg> <span class="astro-wkojbtzc sr-only">Share this post via Telegram</span> </a><a href="https://pinterest.com/pin/create/button/?url=https://chou401.github.io/astro/posts/mybatis-integrated-underlying-source-code/" class="astro-wkojbtzc group hover:text-skin-accent inline-block link-button" title="Share this post on Pinterest"> <svg xmlns="http://www.w3.org/2000/svg" class="icon-tabler" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <line x1="8" y1="20" x2="12" y2="11"></line>
      <path d="M10.7 14c.437 1.263 1.43 2 2.55 2c2.071 0 3.75 -1.554 3.75 -4a5 5 0 1 0 -9.7 1.7"></path>
      <circle cx="12" cy="12" r="9"></circle>
    </svg> <span class="astro-wkojbtzc sr-only">Share this post on Pinterest</span> </a><a href="mailto:?subject=See%20this%20post&amp;body=https://chou401.github.io/astro/posts/mybatis-integrated-underlying-source-code/" class="astro-wkojbtzc group hover:text-skin-accent inline-block link-button" title="Share this post via email"> <svg xmlns="http://www.w3.org/2000/svg" class="icon-tabler" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <rect x="3" y="5" width="18" height="14" rx="2"></rect>
      <polyline points="3 7 12 13 21 7"></polyline>
    </svg> <span class="astro-wkojbtzc sr-only">Share this post via email</span> </a> </div> </div>  </div> </main> <footer class="astro-sz7xmlte mt-auto"> <div class="max-w-3xl mx-auto px-0"> <hr class="border-skin-line" aria-hidden="true"> </div> <div class="astro-sz7xmlte footer-wrapper"> <div class="astro-upu6fzxr flex social-icons"> <a href="https://github.com/chou401/astro" class="inline-block group hover:text-skin-accent link-button astro-upu6fzxr" title=" 知道的越多，才知知道的越少 on Github"> <svg xmlns="http://www.w3.org/2000/svg" class="icon-tabler" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
    <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path>
  </svg> <span class="sr-only astro-upu6fzxr"> 知道的越多，才知知道的越少 on Github</span> </a><a href="https://github.com/chou401/astro" class="inline-block group hover:text-skin-accent link-button astro-upu6fzxr" title="知道的越多，才知知道的越少 on Facebook"> <svg xmlns="http://www.w3.org/2000/svg" class="icon-tabler" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
    <path d="M7 10v4h3v7h4v-7h3l1 -4h-4v-2a1 1 0 0 1 1 -1h3v-4h-3a5 5 0 0 0 -5 5v2h-3"></path>
  </svg> <span class="sr-only astro-upu6fzxr">知道的越多，才知知道的越少 on Facebook</span> </a><a href="https://github.com/chou401/astro" class="inline-block group hover:text-skin-accent link-button astro-upu6fzxr" title="知道的越多，才知知道的越少 on Instagram"> <svg xmlns="http://www.w3.org/2000/svg" class="icon-tabler" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
    <rect x="4" y="4" width="16" height="16" rx="4"></rect>
    <circle cx="12" cy="12" r="3"></circle>
    <line x1="16.5" y1="7.5" x2="16.5" y2="7.501"></line>
  </svg> <span class="sr-only astro-upu6fzxr">知道的越多，才知知道的越少 on Instagram</span> </a><a href="https://github.com/chou401/astro" class="inline-block group hover:text-skin-accent link-button astro-upu6fzxr" title="知道的越多，才知知道的越少 on LinkedIn"> <svg xmlns="http://www.w3.org/2000/svg" class="icon-tabler" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
    <rect x="4" y="4" width="16" height="16" rx="2"></rect>
    <line x1="8" y1="11" x2="8" y2="16"></line>
    <line x1="8" y1="8" x2="8" y2="8.01"></line>
    <line x1="12" y1="16" x2="12" y2="11"></line>
    <path d="M16 16v-3a2 2 0 0 0 -4 0"></path>
  </svg> <span class="sr-only astro-upu6fzxr">知道的越多，才知知道的越少 on LinkedIn</span> </a> </div>  <div class="astro-sz7xmlte copyright-wrapper"> <span class="astro-sz7xmlte">Copyright © 2024</span> <span class="astro-sz7xmlte separator">&nbsp;|&nbsp;</span> <span class="astro-sz7xmlte">All rights reserved.</span> </div> </div> </footer>     <script>function addHeadingLinks(){let c=Array.from(document.querySelectorAll("h2, h3, h4, h5, h6"));for(let d of c){d.classList.add("group");let t=document.createElement("a");t.innerText="#",t.className="heading-link hidden group-hover:inline-block ml-2",t.href="#"+d.id,t.ariaHidden="true",d.appendChild(t)}}addHeadingLinks();function attachCopyButtons(){let c="Copy",d=Array.from(document.querySelectorAll("pre"));for(let e of d){let o=document.createElement("div");o.style.position="relative";let n=document.createElement("button");n.className="copy-code absolute right-3 -top-3 rounded bg-skin-card px-2 py-1 text-xs leading-4 text-skin-base font-medium",n.innerHTML=c,e.setAttribute("tabindex","0"),e.appendChild(n),e?.parentNode?.insertBefore(o,e),o.appendChild(e),n.addEventListener("click",async()=>{await t(e,n)})}async function t(e,o){let i=e.querySelector("code")?.innerText;await navigator.clipboard.writeText(i??""),o.innerText="Copied",setTimeout(()=>{o.innerText=c},700)}}attachCopyButtons();function backToTop(){document.querySelector("#back-to-top")?.addEventListener("click",()=>{document.body.scrollTop=0,document.documentElement.scrollTop=0})}backToTop();
</script></body></html>